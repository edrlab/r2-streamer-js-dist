{"version":3,"file":"media-overlay.js","sourceRoot":"","sources":["../../../../src/models/media-overlay.ts"],"names":[],"mappings":"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","sourcesContent":["// https://github.com/edcarroll/ta-json\nimport {\n    JsonElementType,\n    JsonObject,\n    JsonProperty,\n} from \"ta-json\";\n\n// http://www.idpf.org/epub/31/spec/epub-mediaoverlays.html#app-clock-examples\n// https://www.w3.org/TR/2008/REC-SMIL3-20081201/smil-timing.html#q22\nexport function timeStrToSeconds(timeStr: string): number {\n    if (!timeStr) {\n        return 0;\n    }\n\n    let hours = 0;\n    let minutes = 0;\n    let seconds = 0;\n\n    try {\n        const iMin = timeStr.indexOf(\"min\");\n        if (iMin > 0) {\n            // time.fraction(min)\n            const minsStr = timeStr.substr(0, iMin);\n            minutes = parseFloat(minsStr);\n        } else {\n            const iMs = timeStr.indexOf(\"ms\");\n            if (iMs > 0) {\n                // time.fraction(ms)\n                const msStr = timeStr.substr(0, iMs);\n                const ms = parseFloat(msStr);\n                seconds = ms / 1000;\n            } else {\n                const iS = timeStr.indexOf(\"s\");\n                if (iS > 0) {\n                    // time.fraction(s)\n                    const sStr = timeStr.substr(0, iS);\n                    seconds = parseFloat(sStr);\n                } else {\n                    const iH = timeStr.indexOf(\"h\");\n                    if (iH > 0) {\n                        // time.fraction(h)\n                        const hStr = timeStr.substr(0, iH);\n                        hours = parseFloat(hStr);\n                    } else {\n                        const arr = timeStr.split(\":\");\n                        if (arr.length === 1) {\n                            // ss.fraction\n                            seconds = parseFloat(arr[0]);\n\n                        } else if (arr.length === 2) {\n                            // mm:ss.fraction\n                            minutes = parseFloat(arr[0]);\n                            seconds = parseFloat(arr[1]);\n\n                        } else if (arr.length === 3) {\n                            // hh:mm:ss.fraction\n                            hours = parseFloat(arr[0]);\n                            minutes = parseFloat(arr[1]);\n                            seconds = parseFloat(arr[2]);\n\n                        } else {\n                            console.log(\"SMIL TIME CLOCK SYNTAX PARSING ERROR ??\");\n                            console.log(timeStr);\n                        }\n                    }\n                }\n            }\n        }\n    } catch (err) {\n        console.log(err);\n        console.log(\"SMIL TIME CLOCK SYNTAX PARSING ERROR!\");\n        console.log(timeStr);\n        return 0;\n    }\n\n    return (hours * 3600) + (minutes * 60) + seconds; // total in seconds\n}\n\n@JsonObject()\nexport class MediaOverlayNode {\n    @JsonProperty(\"text\")\n    public Text: string;\n\n    @JsonProperty(\"audio\")\n    public Audio: string;\n\n    @JsonProperty(\"role\")\n    @JsonElementType(String)\n    public Role: string[];\n\n    @JsonProperty(\"children\")\n    @JsonElementType(MediaOverlayNode)\n    public Children: MediaOverlayNode[];\n\n    public SmilPathInZip: string;\n\n    // public inspect(depth: number, opts: any): string | null | undefined {\n    //     return \"MediaOverlay: \" + this.SmilPathInZip;\n    // }\n\n    // constructor(text: string = \"T3\") {\n    //     this._JsonConstructor(text);\n    // }\n\n    // @JsonConstructor()\n    // private _JsonConstructor(text: string = \"T2\") {\n    //     console.log(\"_JsonConstructor\");\n    //     console.log(\"!!!! \" + text);\n\n    //     this.Text = text;\n    // }\n\n    // @BeforeDeserialized()\n    // private _BeforeDeserialized() {\n    //     console.log(\"_BeforeDeserialized\");\n\n    //     this.Text = \"T1\";\n    //     // this.Audio = \"\";\n    // }\n\n    // @OnDeserialized()\n    //// tslint:disable-next-line:no-unused-variable\n    // private _OnDeserialized() {\n    //     console.log(\"_OnDeserialized\");\n    //     console.log(\"==> \" + this.info);\n    // }\n\n    // public get info(): string {\n    //     return `${this.Text} + ${this.Audio} - ` + (this.Children ? this.Children.length : \"0\");\n    // }\n}\n"]}