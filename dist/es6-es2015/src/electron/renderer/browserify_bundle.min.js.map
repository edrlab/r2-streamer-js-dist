{"version":3,"sources":["../../../../../node_modules/browser-pack/_prelude.js","../../../../../src/electron/renderer/index.ts","../../../../../src/electron/renderer/index_navigator.ts","../../../../../src/electron/renderer/querystring.ts","../../../../../node_modules/debounce/index.js","../../../../../node_modules/tslib/tslib.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","electron_1","index_navigator_1","querystring_1","console","log","window","location","document","baseURI","URL","queryParams","getURLQueryParams","publicationJsonUrl","lcpHint","onerror","err","ipcRenderer","on","_event","okay","message","lcpPassInput","getElementById","value","setTimeout","lcpPassForm","style","display","addEventListener","pathBase64","replace","pathDecoded","atob","pathFileName","substr","lastIndexOf","h1","querySelector","textContent","evt","preventDefault","lcpPass","send","buttStart","setAttribute","startNavigatorExperiment","buttonDebug","documentElement","classList","contains","remove","add","buttonDevTools","appendToc","json","anchor","webview1","ul","createElement","forEach","tocLinkJson","li","title","href","tocLink","tocLinkHref","event","appendChild","createTextNode","br","tocHeading","children","debounce","body","backgroundColor","color","readerControls","showControlsButton","hideControlsButt","width","clientWidth","height","clientHeight","wc","getWebContents","setSize","normal","channel","args","cssButtonN1","removeAttribute","cssButtonN2","publicationViewport","hideControlsButton","cssButton1","jsonMsg","injectCSS","setCSS","JSON","stringify","cssButton2","tslib_1","__awaiter","this","response","fetch","ok","headers","arg0","arg1","publicationJson","spine","readerControlsSpine","spineItem","spineItemLink","spineItemLinkHref","toc","readerControlsToc","readerControlsPageList","readerControlsLandmarks","landmarks","lot","loa","loi","lov","params","query","search","substring","split","keyParam","keyVal","decodeURIComponent","func","wait","immediate","later","last","Date","now","timestamp","timeout","result","apply","context","debounced","arguments","callNow","clear","clearTimeout","__extends","__assign","__rest","__decorate","__param","__metadata","__generator","__exportStar","__values","__read","__spread","__await","__asyncGenerator","__asyncDelegator","__asyncValues","factory","createExporter","previous","id","v","root","global","self","define","amd","exporter","extendStatics","Object","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","prototype","create","assign","indexOf","getOwnPropertySymbols","decorators","target","key","desc","c","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","paramIndex","decorator","metadataKey","metadataValue","metadata","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","done","then","verb","op","TypeError","_","y","label","ops","pop","trys","push","g","sent","throw","return","Symbol","iterator","m","ar","error","concat","q","resume","settle","fulfill","shift","asyncIterator"],"mappings":"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","sourceRoot":"","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import { ipcRenderer } from \"electron\";\nimport { startNavigatorExperiment } from \"./index_navigator\";\nimport { getURLQueryParams } from \"./querystring\";\n\n// import { startServiceWorkerExperiment } from \"./sw/index_service-worker\";\n\nconsole.log(\"INDEX\");\n\nconsole.log(window.location);\nconsole.log(document.baseURI);\nconsole.log(document.URL);\n\nconst queryParams = getURLQueryParams();\n\n// tslint:disable-next-line:no-string-literal\nconst publicationJsonUrl = queryParams[\"pub\"];\n\nconsole.log(\" (((( publicationJsonUrl )))) \" + publicationJsonUrl);\n\n// tslint:disable-next-line:no-string-literal\nconst lcpHint = queryParams[\"lcpHint\"];\n\nwindow.onerror = (err) => {\n    console.log(\"Error\", err);\n};\n\nipcRenderer.on(\"tryLcpPass\", (_event: any, okay: boolean, message: string) => {\n    console.log(okay);\n    console.log(message);\n\n    const lcpPassInput = document.getElementById(\"lcpPassInput\");\n    if (!lcpPassInput) {\n        return;\n    }\n\n    (lcpPassInput as HTMLInputElement).value = message;\n\n    if (okay) {\n        setTimeout(() => {\n            const lcpPassForm = document.getElementById(\"lcpPassForm\");\n            if (!lcpPassForm) {\n                return;\n            }\n            lcpPassForm.style.display = \"none\";\n        }, 1000);\n    }\n});\n\nwindow.addEventListener(\"DOMContentLoaded\", () => {\n\n    const pathBase64 = publicationJsonUrl.replace(/.*\\/pub\\/(.*)\\/manifest.json/, \"$1\");\n    console.log(pathBase64);\n    const pathDecoded = window.atob(pathBase64);\n    console.log(pathDecoded);\n    const pathFileName = pathDecoded.substr(pathDecoded.lastIndexOf(\"/\") + 1, pathDecoded.length - 1);\n\n    const h1 = document.querySelector(\"html > body > h1 > span\");\n    if (h1) {\n        (h1 as HTMLElement).textContent = pathFileName;\n    }\n\n    const lcpPassForm = document.getElementById(\"lcpPassForm\");\n    if (!lcpPassForm) {\n        return;\n    }\n    const lcpPassInput = document.getElementById(\"lcpPassInput\");\n    if (!lcpPassInput) {\n        return;\n    }\n    if (lcpHint) {\n        (lcpPassInput as HTMLInputElement).value = lcpHint;\n        lcpPassForm.style.display = \"inline-block\";\n        // lcpPassForm.onsubmit\n        lcpPassForm.addEventListener(\"submit\", (evt) => {\n            if (evt) {\n                evt.preventDefault();\n            }\n            const lcpPass = (lcpPassInput as HTMLInputElement).value;\n            ipcRenderer.send(\"tryLcpPass\", pathDecoded, lcpPass);\n            return false;\n        });\n    }\n\n    const buttStart = document.getElementById(\"buttonStart\");\n    if (!buttStart) {\n        return;\n    }\n    buttStart.addEventListener(\"click\", () => {\n        buttStart.setAttribute(\"disabled\", \"\");\n        buttStart.style.display = \"none\";\n        // startServiceWorkerExperiment(publicationJsonUrl);\n        startNavigatorExperiment(publicationJsonUrl);\n    });\n\n    const buttonDebug = document.getElementById(\"buttonDebug\");\n    if (!buttonDebug) {\n        return;\n    }\n    buttonDebug.addEventListener(\"click\", () => {\n        if (document.documentElement.classList.contains(\"debug\")) {\n            document.documentElement.classList.remove(\"debug\");\n        } else {\n            document.documentElement.classList.add(\"debug\");\n        }\n    });\n\n    const buttonDevTools = document.getElementById(\"buttonDevTools\");\n    if (!buttonDevTools) {\n        return;\n    }\n    buttonDevTools.addEventListener(\"click\", () => {\n        ipcRenderer.send(\"devtools\", \"test\");\n    });\n});\n","import debounce = require(\"debounce\");\n// import * as debounce from \"debounce\";\n// import { debounce } from \"debounce\";\n\nexport function startNavigatorExperiment(publicationJsonUrl: string) {\n\n    document.body.style.backgroundColor = \"silver\";\n\n    const h1 = document.querySelector(\"html > body > h1\");\n    if (h1) {\n        (h1 as HTMLElement).style.color = \"green\";\n    }\n\n    // const readerChrome = document.getElementById(\"reader_chrome\");\n    const readerControls = document.getElementById(\"reader_controls\");\n\n    const showControlsButton = document.getElementById(\"showControlsButton\");\n    if (showControlsButton) {\n        showControlsButton.style.display = \"block\";\n        showControlsButton.addEventListener(\"click\", (_event) => {\n            if (readerControls) {\n                readerControls.style.display = \"block\";\n            }\n            const hideControlsButt = document.getElementById(\"hideControlsButton\");\n            if (hideControlsButt) {\n                hideControlsButt.style.display = \"block \";\n            }\n        });\n    }\n\n    const webview1 = document.createElement(\"webview\");\n    webview1.setAttribute(\"id\", \"webview1\");\n    webview1.setAttribute(\"webpreferences\",\n        \"nodeIntegration=0, nodeIntegrationInWorker=0, sandbox=0, javascript=1, \" +\n        \"contextIsolation=0, webSecurity=1, allowRunningInsecureContent=0\");\n    webview1.setAttribute(\"partition\", \"persist:publicationwebview\");\n    webview1.setAttribute(\"httpreferrer\", publicationJsonUrl);\n    webview1.setAttribute(\"preload\", \"./preload.js\");\n    // webview.setAttribute(\"src\", \"dummy\");\n    // webview1.style.visibility = \"hidden\";\n    webview1.setAttribute(\"disableguestresize\", \"\");\n    window.addEventListener(\"resize\", debounce(() => {\n\n        // webview.offsetWidth == full including borders\n        // webview.scrollWidth == webview.clientWidth == without borders\n\n        // const computedStyle = window.getComputedStyle(webview1);\n        // console.log(parseInt(computedStyle.width as string, 10));\n        // console.log(parseInt(computedStyle.height as string, 10));\n\n        const width = webview1.clientWidth;\n        const height = webview1.clientHeight;\n\n        const wc = webview1.getWebContents();\n        if (wc && width && height) {\n            wc.setSize({\n                normal: {\n                    height,\n                    width,\n                },\n            });\n        }\n    }, 200));\n    webview1.addEventListener(\"ipc-message\", (event) => {\n        console.log(\"webview1 ipc-message\");\n        console.log(event.channel);\n        if (event.channel === \"readium\") {\n            console.log(event.args);\n        }\n    });\n    webview1.addEventListener(\"dom-ready\", () => {\n        // webview1.openDevTools();\n\n        const cssButtonN1 = document.getElementById(\"cssButtonInject\");\n        if (!cssButtonN1) {\n            return;\n        }\n        cssButtonN1.removeAttribute(\"disabled\");\n\n        const cssButtonN2 = document.getElementById(\"cssButtonReset\");\n        if (!cssButtonN2) {\n            return;\n        }\n        cssButtonN2.removeAttribute(\"disabled\");\n\n        // webview1.style.visibility = \"visible\";\n    });\n    const publicationViewport = document.getElementById(\"publication_viewport\");\n    if (publicationViewport) {\n        publicationViewport.appendChild(webview1);\n    }\n\n    const hideControlsButton = document.getElementById(\"hideControlsButton\");\n    if (hideControlsButton) {\n        hideControlsButton.addEventListener(\"click\", (_event) => {\n            if (readerControls) {\n                readerControls.style.display = \"none\";\n            }\n            hideControlsButton.style.display = \"none\";\n        });\n    }\n\n    const cssButton1 = document.getElementById(\"cssButtonInject\");\n    if (cssButton1) {\n        cssButton1.addEventListener(\"click\", (_event) => {\n            const jsonMsg = { injectCSS: \"yes\", setCSS: \"ok\" };\n            webview1.send(\"readium\", JSON.stringify(jsonMsg)); // .getWebContents()\n        });\n    }\n\n    const cssButton2 = document.getElementById(\"cssButtonReset\");\n    if (cssButton2) {\n        cssButton2.addEventListener(\"click\", (_event) => {\n            const jsonMsg = { injectCSS: \"rollback\", setCSS: \"rollback\" };\n            webview1.send(\"readium\", JSON.stringify(jsonMsg)); // .getWebContents()\n        });\n    }\n\n    // tslint:disable-next-line:no-floating-promises\n    (async () => {\n\n        // try {\n        //     // hacky :) (just for testing);\n        //     // (initializes the LCP pass)\n        //     await fetch(publicationJsonUrl.replace(\"/pub/\",\n        //         \"/pub/*-\" +\n        //         \"ZWM0ZjJkYmIzYjE0MDA5NTU1MGM5YWZiYmI2OWI1ZDZmZDllODE0YjlkYTgyZmFkMGIzNGU5ZmNiZTU2ZjFjYg\" +\n        //         \"==-*\"));\n        // } catch (e) {\n        //     console.log(e);\n        // }\n\n        let response: Response | undefined;\n        try {\n            response = await fetch(publicationJsonUrl);\n        } catch (e) {\n            console.log(e);\n        }\n        if (!response) {\n            return;\n        }\n        if (!response.ok) {\n            console.log(\"BAD RESPONSE?!\");\n        }\n        response.headers.forEach((arg0: any, arg1: any) => {\n            console.log(arg0 + \" => \" + arg1);\n        });\n\n        let publicationJson: any | undefined;\n        try {\n            publicationJson = await response.json();\n        } catch (e) {\n            console.log(e);\n        }\n        if (!publicationJson) {\n            return;\n        }\n        console.log(publicationJson);\n\n        if (publicationJson.spine) {\n            const readerControlsSpine = document.getElementById(\"reader_controls_SPINE\");\n            publicationJson.spine.forEach((spineItem: any) => {\n                const spineItemLink = document.createElement(\"a\");\n                const spineItemLinkHref = publicationJsonUrl + \"/../\" + spineItem.href;\n                spineItemLink.setAttribute(\"href\", spineItemLinkHref);\n                spineItemLink.addEventListener(\"click\", (event) => {\n                    event.preventDefault();\n\n                    webview1.setAttribute(\"src\", spineItemLinkHref);\n                    // webview1.getWebContents().loadURL(spineItemLinkHref, { extraHeaders: \"pragma: no-cache\\n\" });\n                    // webview1.loadURL(spineItemLinkHref, { extraHeaders: \"pragma: no-cache\\n\" });\n                });\n                spineItemLink.appendChild(document.createTextNode(spineItem.href));\n                if (readerControlsSpine) {\n                    readerControlsSpine.appendChild(spineItemLink);\n                    readerControlsSpine.appendChild(document.createElement(\"br\"));\n                }\n            });\n        }\n\n        if (publicationJson.toc && publicationJson.toc.length) {\n            const readerControlsToc = document.getElementById(\"reader_controls_TOC\");\n            if (readerControlsToc) {\n                appendToc(publicationJson.toc, readerControlsToc, publicationJsonUrl, webview1);\n            }\n        }\n        if (publicationJson[\"page-list\"] && publicationJson[\"page-list\"].length) {\n            const readerControlsPageList = document.getElementById(\"reader_controls_PAGELIST\");\n            if (readerControlsPageList) {\n                appendToc(publicationJson[\"page-list\"], readerControlsPageList, publicationJsonUrl, webview1);\n            }\n        }\n\n        const readerControlsLandmarks = document.getElementById(\"reader_controls_LANDMARKS\");\n        if (readerControlsLandmarks) {\n            if (publicationJson.landmarks && publicationJson.landmarks.length) {\n                appendToc(publicationJson.landmarks, readerControlsLandmarks, publicationJsonUrl, webview1);\n            }\n            if (publicationJson.lot && publicationJson.lot.length) {\n                readerControlsLandmarks.appendChild(document.createElement(\"hr\"));\n                appendToc(publicationJson.lot, readerControlsLandmarks, publicationJsonUrl, webview1);\n            }\n            if (publicationJson.loa && publicationJson.loa.length) {\n                readerControlsLandmarks.appendChild(document.createElement(\"hr\"));\n                appendToc(publicationJson.loa, readerControlsLandmarks, publicationJsonUrl, webview1);\n            }\n            if (publicationJson.loi && publicationJson.loi.length) {\n                readerControlsLandmarks.appendChild(document.createElement(\"hr\"));\n                appendToc(publicationJson.loi, readerControlsLandmarks, publicationJsonUrl, webview1);\n            }\n            if (publicationJson.lov && publicationJson.lov.length) {\n                readerControlsLandmarks.appendChild(document.createElement(\"hr\"));\n                appendToc(publicationJson.lov, readerControlsLandmarks, publicationJsonUrl, webview1);\n            }\n        }\n    })();\n    //     const spineItemUrl = publicationJsonUrl + \"/../\" + publicationJson.spine[0].href;\n    //     console.log(spineItemUrl);\n    //     webview1.setAttribute(\"src\", spineItemUrl);\n\n    // const a = document.querySelector(\"html > body > a\");\n    // a.click();\n}\n\nfunction appendToc(json: any, anchor: HTMLElement, publicationJsonUrl: string, webview1: HTMLElement) {\n\n    const ul = document.createElement(\"ul\");\n    json.forEach((tocLinkJson: any) => {\n        const li = document.createElement(\"li\");\n\n        if (!tocLinkJson.title) {\n            tocLinkJson.title = \"xxx\";\n        }\n\n        if (tocLinkJson.href) {\n            const tocLink = document.createElement(\"a\");\n            const tocLinkHref = publicationJsonUrl + \"/../\" + tocLinkJson.href;\n            tocLink.setAttribute(\"href\", tocLinkHref);\n            tocLink.addEventListener(\"click\", (event) => {\n                event.preventDefault();\n\n                webview1.setAttribute(\"src\", tocLinkHref);\n                // webview1.getWebContents().loadURL(tocLinkHref, { extraHeaders: \"pragma: no-cache\\n\" });\n                // webview1.loadURL(tocLinkHref, { extraHeaders: \"pragma: no-cache\\n\" });\n            });\n            tocLink.appendChild(document.createTextNode(tocLinkJson.title));\n            li.appendChild(tocLink);\n\n            const br = document.createElement(\"br\");\n            li.appendChild(br);\n\n            const tocHeading = document.createElement(\"span\");\n            tocHeading.appendChild(document.createTextNode(tocLinkJson.href));\n            li.appendChild(tocHeading);\n        } else {\n            const tocHeading = document.createElement(\"span\");\n            tocHeading.appendChild(document.createTextNode(tocLinkJson.title));\n            li.appendChild(tocHeading);\n        }\n\n        ul.appendChild(li);\n\n        if (tocLinkJson.children && tocLinkJson.children.length) {\n            appendToc(tocLinkJson.children, li, publicationJsonUrl, webview1);\n        }\n    });\n\n    anchor.appendChild(ul);\n}\n","export interface IStringMap { [key: string]: string; }\n\nexport const getURLQueryParams = (): IStringMap => {\n    const params: IStringMap = {};\n\n    let query = window.location.search;\n    if (query && query.length) {\n        query = query.substring(1);\n        const keyParams = query.split(\"&\");\n        keyParams.forEach((keyParam) => {\n            const keyVal = keyParam.split(\"=\");\n            if (keyVal.length > 1) {\n                params[keyVal[0]] = decodeURIComponent(keyVal[1]);\n            }\n        });\n    }\n\n    return params;\n};\n","/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing. The function also has a property 'clear' \n * that is a function which will clear the timer to prevent previously scheduled executions. \n *\n * @source underscore.js\n * @see http://unscriptable.com/2009/03/20/debouncing-javascript-methods/\n * @param {Function} function to wrap\n * @param {Number} timeout in ms (`100`)\n * @param {Boolean} whether to execute at the beginning (`false`)\n * @api public\n */\n\nmodule.exports = function debounce(func, wait, immediate){\n  var timeout, args, context, timestamp, result;\n  if (null == wait) wait = 100;\n\n  function later() {\n    var last = Date.now() - timestamp;\n\n    if (last < wait && last >= 0) {\n      timeout = setTimeout(later, wait - last);\n    } else {\n      timeout = null;\n      if (!immediate) {\n        result = func.apply(context, args);\n        context = args = null;\n      }\n    }\n  };\n\n  var debounced = function(){\n    context = this;\n    args = arguments;\n    timestamp = Date.now();\n    var callNow = immediate && !timeout;\n    if (!timeout) timeout = setTimeout(later, wait);\n    if (callNow) {\n      result = func.apply(context, args);\n      context = args = null;\n    }\n\n    return result;\n  };\n\n  debounced.clear = function() {\n    if (timeout) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n\n  return debounced;\n};\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global global, define, System, Reflect, Promise */\r\nvar __extends;\r\nvar __assign;\r\nvar __rest;\r\nvar __decorate;\r\nvar __param;\r\nvar __metadata;\r\nvar __awaiter;\r\nvar __generator;\r\nvar __exportStar;\r\nvar __values;\r\nvar __read;\r\nvar __spread;\r\nvar __await;\r\nvar __asyncGenerator;\r\nvar __asyncDelegator;\r\nvar __asyncValues;\r\n(function (factory) {\r\n    var root = typeof global === \"object\" ? global : typeof self === \"object\" ? self : typeof this === \"object\" ? this : {};\r\n    if (typeof define === \"function\" && define.amd) {\r\n        define(\"tslib\", [\"exports\"], function (exports) { factory(createExporter(root, createExporter(exports))); });\r\n    }\r\n    else if (typeof module === \"object\" && typeof module.exports === \"object\") {\r\n        factory(createExporter(root, createExporter(module.exports)));\r\n    }\r\n    else {\r\n        factory(createExporter(root));\r\n    }\r\n    function createExporter(exports, previous) {\r\n        return function (id, v) { return exports[id] = previous ? previous(id, v) : v; };\r\n    }\r\n})\r\n(function (exporter) {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\n    __extends = function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n\r\n    __assign = Object.assign || function (t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n\r\n    __rest = function (s, e) {\r\n        var t = {};\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n            t[p] = s[p];\r\n        if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n            for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n                t[p[i]] = s[p[i]];\r\n        return t;\r\n    };\r\n\r\n    __decorate = function (decorators, target, key, desc) {\r\n        var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n        if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n        else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n        return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n    };\r\n\r\n    __param = function (paramIndex, decorator) {\r\n        return function (target, key) { decorator(target, key, paramIndex); }\r\n    };\r\n\r\n    __metadata = function (metadataKey, metadataValue) {\r\n        if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n    };\r\n\r\n    __awaiter = function (thisArg, _arguments, P, generator) {\r\n        return new (P || (P = Promise))(function (resolve, reject) {\r\n            function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n            function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n            function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n        });\r\n    };\r\n\r\n    __generator = function (thisArg, body) {\r\n        var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n        return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n        function verb(n) { return function (v) { return step([n, v]); }; }\r\n        function step(op) {\r\n            if (f) throw new TypeError(\"Generator is already executing.\");\r\n            while (_) try {\r\n                if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\r\n                if (y = 0, t) op = [0, t.value];\r\n                switch (op[0]) {\r\n                    case 0: case 1: t = op; break;\r\n                    case 4: _.label++; return { value: op[1], done: false };\r\n                    case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                    case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                    default:\r\n                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                        if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                        if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                        if (t[2]) _.ops.pop();\r\n                        _.trys.pop(); continue;\r\n                }\r\n                op = body.call(thisArg, _);\r\n            } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n            if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n        }\r\n    };\r\n\r\n    __exportStar = function (m, exports) {\r\n        for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n    };\r\n\r\n    __values = function (o) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n        if (m) return m.call(o);\r\n        return {\r\n            next: function () {\r\n                if (o && i >= o.length) o = void 0;\r\n                return { value: o && o[i++], done: !o };\r\n            }\r\n        };\r\n    };\r\n\r\n    __read = function (o, n) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n        if (!m) return o;\r\n        var i = m.call(o), r, ar = [], e;\r\n        try {\r\n            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n        }\r\n        catch (error) { e = { error: error }; }\r\n        finally {\r\n            try {\r\n                if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n            }\r\n            finally { if (e) throw e.error; }\r\n        }\r\n        return ar;\r\n    };\r\n\r\n    __spread = function () {\r\n        for (var ar = [], i = 0; i < arguments.length; i++)\r\n            ar = ar.concat(__read(arguments[i]));\r\n        return ar;\r\n    };\r\n\r\n    __await = function (v) {\r\n        return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n    };\r\n\r\n    __asyncGenerator = function (thisArg, _arguments, generator) {\r\n        if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n        var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n        return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n        function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n        function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n        function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\r\n        function fulfill(value) { resume(\"next\", value); }\r\n        function reject(value) { resume(\"throw\", value); }\r\n        function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n    };\r\n\r\n    __asyncDelegator = function (o) {\r\n        var i, p;\r\n        return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n        function verb(n, f) { if (o[n]) i[n] = function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; }; }\r\n    };\r\n\r\n    __asyncValues = function (o) {\r\n        if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n        var m = o[Symbol.asyncIterator];\r\n        return m ? m.call(o) : typeof __values === \"function\" ? __values(o) : o[Symbol.iterator]();\r\n    };\r\n\r\n    exporter(\"__extends\", __extends);\r\n    exporter(\"__assign\", __assign);\r\n    exporter(\"__rest\", __rest);\r\n    exporter(\"__decorate\", __decorate);\r\n    exporter(\"__param\", __param);\r\n    exporter(\"__metadata\", __metadata);\r\n    exporter(\"__awaiter\", __awaiter);\r\n    exporter(\"__generator\", __generator);\r\n    exporter(\"__exportStar\", __exportStar);\r\n    exporter(\"__values\", __values);\r\n    exporter(\"__read\", __read);\r\n    exporter(\"__spread\", __spread);\r\n    exporter(\"__await\", __await);\r\n    exporter(\"__asyncGenerator\", __asyncGenerator);\r\n    exporter(\"__asyncDelegator\", __asyncDelegator);\r\n    exporter(\"__asyncValues\", __asyncValues);\r\n});"]}