!function e(t,n,o){function r(l,i){if(!n[l]){if(!t[l]){var a="function"==typeof require&&require;if(!i&&a)return a(l,!0);if(c)return c(l,!0);var s=new Error("Cannot find module '"+l+"'");throw s.code="MODULE_NOT_FOUND",s}var u=n[l]={exports:{}};t[l][0].call(u.exports,function(e){var n=t[l][1][e];return r(n||e)},u,u.exports,e,t,n,o)}return n[l].exports}for(var c="function"==typeof require&&require,l=0;l<o.length;l++)r(o[l]);return r}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const o=e("electron"),r=e("./index_navigator"),c=e("./querystring");console.log("INDEX"),console.log(window.location),console.log(document.baseURI),console.log(document.URL);const l=c.getURLQueryParams(),i=l.pub;console.log(" (((( publicationJsonUrl )))) "+i);const a=l.lcpHint;window.onerror=(e=>{console.log("Error",e)}),o.ipcRenderer.on("tryLcpPass",(e,t,n)=>{console.log(t),console.log(n);const o=document.getElementById("lcpPassInput");o&&(o.value=n,t&&setTimeout(()=>{const e=document.getElementById("lcpPassForm");e&&(e.style.display="none")},1e3))}),window.addEventListener("DOMContentLoaded",()=>{const e=i.replace(/.*\/pub\/(.*)\/manifest.json/,"$1");console.log(e);const t=window.atob(e);console.log(t);const n=t.substr(t.lastIndexOf("/")+1,t.length-1),c=document.querySelector("html > body > h1 > span");c&&(c.textContent=n);const l=document.getElementById("lcpPassForm");if(!l)return;const s=document.getElementById("lcpPassInput");if(!s)return;a&&(s.value=a,l.style.display="inline-block",l.addEventListener("submit",e=>{e&&e.preventDefault();const n=s.value;return o.ipcRenderer.send("tryLcpPass",t,n),!1}));const u=document.getElementById("buttonStart");if(!u)return;u.addEventListener("click",()=>{u.setAttribute("disabled",""),u.style.display="none",r.startNavigatorExperiment(i)});const d=document.getElementById("buttonDebug");if(!d)return;d.addEventListener("click",()=>{document.documentElement.classList.contains("debug")?document.documentElement.classList.remove("debug"):document.documentElement.classList.add("debug")});const f=document.getElementById("buttonDevTools");f&&f.addEventListener("click",()=>{o.ipcRenderer.send("devtools","test")})})},{"./index_navigator":2,"./querystring":3,electron:void 0}],2:[function(e,t,n){"use strict";function o(e,t,n,r){const c=document.createElement("ul");e.forEach(e=>{const t=document.createElement("li");if(e.title||(e.title="xxx"),e.href){const o=document.createElement("a"),c=n+"/../"+e.href;o.setAttribute("href",c),o.addEventListener("click",e=>{e.preventDefault(),r.setAttribute("src",c)}),o.appendChild(document.createTextNode(e.title)),t.appendChild(o);const l=document.createElement("br");t.appendChild(l);const i=document.createElement("span");i.appendChild(document.createTextNode(e.href)),t.appendChild(i)}else{const n=document.createElement("span");n.appendChild(document.createTextNode(e.title)),t.appendChild(n)}c.appendChild(t),e.children&&e.children.length&&o(e.children,t,n,r)}),t.appendChild(c)}Object.defineProperty(n,"__esModule",{value:!0});const r=e("tslib"),c=e("debounce");n.startNavigatorExperiment=function(e){document.body.style.backgroundColor="silver";const t=document.querySelector("html > body > h1");t&&(t.style.color="green");const n=document.getElementById("reader_controls"),l=document.getElementById("showControlsButton");l&&(l.style.display="block",l.addEventListener("click",e=>{n&&(n.style.display="block");const t=document.getElementById("hideControlsButton");t&&(t.style.display="block ")}));const i=document.createElement("webview");i.setAttribute("id","webview1"),i.setAttribute("webpreferences","nodeIntegration=0, nodeIntegrationInWorker=0, sandbox=0, javascript=1, contextIsolation=0, webSecurity=1, allowRunningInsecureContent=0"),i.setAttribute("partition","persist:publicationwebview"),i.setAttribute("httpreferrer",e),i.setAttribute("preload","./preload.js"),i.setAttribute("disableguestresize",""),window.addEventListener("resize",c(()=>{const e=i.clientWidth,t=i.clientHeight,n=i.getWebContents();n&&e&&t&&n.setSize({normal:{height:t,width:e}})},200)),i.addEventListener("ipc-message",e=>{console.log("webview1 ipc-message"),console.log(e.channel),"readium"===e.channel&&console.log(e.args)}),i.addEventListener("dom-ready",()=>{const e=document.getElementById("cssButtonInject");if(!e)return;e.removeAttribute("disabled");const t=document.getElementById("cssButtonReset");t&&t.removeAttribute("disabled")});const a=document.getElementById("publication_viewport");a&&a.appendChild(i);const s=document.getElementById("hideControlsButton");s&&s.addEventListener("click",e=>{n&&(n.style.display="none"),s.style.display="none"});const u=document.getElementById("cssButtonInject");u&&u.addEventListener("click",e=>{const t={injectCSS:"yes",setCSS:"ok"};i.send("readium",JSON.stringify(t))});const d=document.getElementById("cssButtonReset");d&&d.addEventListener("click",e=>{const t={injectCSS:"rollback",setCSS:"rollback"};i.send("readium",JSON.stringify(t))}),(()=>r.__awaiter(this,void 0,void 0,function*(){let t;try{t=yield fetch(e)}catch(e){console.log(e)}if(!t)return;t.ok||console.log("BAD RESPONSE?!"),t.headers.forEach((e,t)=>{console.log(e+" => "+t)});let n;try{n=yield t.json()}catch(e){console.log(e)}if(!n)return;if(console.log(n),n.spine){const t=document.getElementById("reader_controls_SPINE");n.spine.forEach(n=>{const o=document.createElement("a"),r=e+"/../"+n.href;o.setAttribute("href",r),o.addEventListener("click",e=>{e.preventDefault(),i.setAttribute("src",r)}),o.appendChild(document.createTextNode(n.href)),t&&(t.appendChild(o),t.appendChild(document.createElement("br")))})}if(n.toc&&n.toc.length){const t=document.getElementById("reader_controls_TOC");t&&o(n.toc,t,e,i)}if(n["page-list"]&&n["page-list"].length){const t=document.getElementById("reader_controls_PAGELIST");t&&o(n["page-list"],t,e,i)}const r=document.getElementById("reader_controls_LANDMARKS");r&&(n.landmarks&&n.landmarks.length&&o(n.landmarks,r,e,i),n.lot&&n.lot.length&&(r.appendChild(document.createElement("hr")),o(n.lot,r,e,i)),n.loa&&n.loa.length&&(r.appendChild(document.createElement("hr")),o(n.loa,r,e,i)),n.loi&&n.loi.length&&(r.appendChild(document.createElement("hr")),o(n.loi,r,e,i)),n.lov&&n.lov.length&&(r.appendChild(document.createElement("hr")),o(n.lov,r,e,i)))}))()}},{debounce:4,tslib:5}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getURLQueryParams=(()=>{const e={};let t=window.location.search;return t&&t.length&&(t=t.substring(1)).split("&").forEach(t=>{const n=t.split("=");n.length>1&&(e[n[0]]=decodeURIComponent(n[1]))}),e})},{}],4:[function(e,t,n){t.exports=function(e,t,n){function o(){var s=Date.now()-i;s<t&&s>=0?r=setTimeout(o,t-s):(r=null,n||(a=e.apply(l,c),l=c=null))}var r,c,l,i,a;null==t&&(t=100);var s=function(){l=this,c=arguments,i=Date.now();var s=n&&!r;return r||(r=setTimeout(o,t)),s&&(a=e.apply(l,c),l=c=null),a};return s.clear=function(){r&&(clearTimeout(r),r=null)},s}},{}],5:[function(e,t,n){(function(e){var n,o,r,c,l,i,a,s,u,d,f,p,y,m,h,b;!function(n){function o(e,t){return function(n,o){return e[n]=t?t(n,o):o}}var r="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:{};"function"==typeof define&&define.amd?define("tslib",["exports"],function(e){n(o(r,o(e)))}):n("object"==typeof t&&"object"==typeof t.exports?o(r,o(t.exports)):o(r))}(function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};n=function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)},o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},r=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&(n[o[r]]=e[o[r]]);return n},c=function(e,t,n,o){var r,c=arguments.length,l=c<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,o);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(c<3?r(l):c>3?r(t,n,l):r(t,n))||l);return c>3&&l&&Object.defineProperty(t,n,l),l},l=function(e,t){return function(n,o){t(n,o,e)}},i=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},a=function(e,t,n,o){return new(n||(n=Promise))(function(r,c){function l(e){try{a(o.next(e))}catch(e){c(e)}}function i(e){try{a(o.throw(e))}catch(e){c(e)}}function a(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(l,i)}a((o=o.apply(e,t||[])).next())})},s=function(e,t){function n(e){return function(t){return o([e,t])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,c&&(l=c[2&n[0]?"return":n[0]?"throw":"next"])&&!(l=l.call(c,n[1])).done)return l;switch(c=0,l&&(n=[0,l.value]),n[0]){case 0:case 1:l=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,c=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(l=a.trys,!(l=l.length>0&&l[l.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!l||n[1]>l[0]&&n[1]<l[3])){a.label=n[1];break}if(6===n[0]&&a.label<l[1]){a.label=l[1],l=n;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(n);break}l[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],c=0}finally{r=l=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,c,l,i,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i},u=function(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])},d=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},f=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,c=n.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(o=c.next()).done;)l.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}return l},p=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e},y=function(e){return this instanceof y?(this.v=e,this):new y(e)},m=function(e,t,n){function o(e){u[e]&&(s[e]=function(t){return new Promise(function(n,o){d.push([e,t,n,o])>1||r(e,t)})})}function r(e,t){try{c(u[e](t))}catch(e){a(d[0][3],e)}}function c(e){e.value instanceof y?Promise.resolve(e.value.v).then(l,i):a(d[0][2],e)}function l(e){r("next",e)}function i(e){r("throw",e)}function a(e,t){e(t),d.shift(),d.length&&r(d[0][0],d[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,u=n.apply(e,t||[]),d=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s},h=function(e){function t(t,r){e[t]&&(n[t]=function(n){return(o=!o)?{value:y(e[t](n)),done:"return"===t}:r?r(n):n})}var n,o;return n={},t("next"),t("throw",function(e){throw e}),t("return"),n[Symbol.iterator]=function(){return this},n},b=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):"function"==typeof d?d(e):e[Symbol.iterator]()},e("__extends",n),e("__assign",o),e("__rest",r),e("__decorate",c),e("__param",l),e("__metadata",i),e("__awaiter",a),e("__generator",s),e("__exportStar",u),e("__values",d),e("__read",f),e("__spread",p),e("__await",y),e("__asyncGenerator",m),e("__asyncDelegator",h),e("__asyncValues",b)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]);
//# sourceMappingURL=browserify_bundle.min.js.map