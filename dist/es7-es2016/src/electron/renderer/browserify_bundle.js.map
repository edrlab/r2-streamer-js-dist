{"version":3,"file":"browserify_bundle_.js","sources":["../../../../../node_modules/tslib/tslib.js","../../../../../node_modules/debounce/index.js","../../../../../src/electron/renderer/querystring.ts","../../../../../src/electron/renderer/index_navigator.ts","../../../../../src/electron/renderer/index.ts","../../../../../node_modules/browser-pack/_prelude.js"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global global, define, System, Reflect, Promise */\r\nvar __extends;\r\nvar __assign;\r\nvar __rest;\r\nvar __decorate;\r\nvar __param;\r\nvar __metadata;\r\nvar __awaiter;\r\nvar __generator;\r\nvar __exportStar;\r\nvar __values;\r\nvar __read;\r\nvar __spread;\r\nvar __await;\r\nvar __asyncGenerator;\r\nvar __asyncDelegator;\r\nvar __asyncValues;\r\n(function (factory) {\r\n    var root = typeof global === \"object\" ? global : typeof self === \"object\" ? self : typeof this === \"object\" ? this : {};\r\n    if (typeof define === \"function\" && define.amd) {\r\n        define(\"tslib\", [\"exports\"], function (exports) { factory(createExporter(root, createExporter(exports))); });\r\n    }\r\n    else if (typeof module === \"object\" && typeof module.exports === \"object\") {\r\n        factory(createExporter(root, createExporter(module.exports)));\r\n    }\r\n    else {\r\n        factory(createExporter(root));\r\n    }\r\n    function createExporter(exports, previous) {\r\n        return function (id, v) { return exports[id] = previous ? previous(id, v) : v; };\r\n    }\r\n})\r\n(function (exporter) {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\n    __extends = function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n\r\n    __assign = Object.assign || function (t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n\r\n    __rest = function (s, e) {\r\n        var t = {};\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n            t[p] = s[p];\r\n        if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n            for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n                t[p[i]] = s[p[i]];\r\n        return t;\r\n    };\r\n\r\n    __decorate = function (decorators, target, key, desc) {\r\n        var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n        if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n        else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n        return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n    };\r\n\r\n    __param = function (paramIndex, decorator) {\r\n        return function (target, key) { decorator(target, key, paramIndex); }\r\n    };\r\n\r\n    __metadata = function (metadataKey, metadataValue) {\r\n        if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n    };\r\n\r\n    __awaiter = function (thisArg, _arguments, P, generator) {\r\n        return new (P || (P = Promise))(function (resolve, reject) {\r\n            function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n            function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n            function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n        });\r\n    };\r\n\r\n    __generator = function (thisArg, body) {\r\n        var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n        return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n        function verb(n) { return function (v) { return step([n, v]); }; }\r\n        function step(op) {\r\n            if (f) throw new TypeError(\"Generator is already executing.\");\r\n            while (_) try {\r\n                if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\r\n                if (y = 0, t) op = [0, t.value];\r\n                switch (op[0]) {\r\n                    case 0: case 1: t = op; break;\r\n                    case 4: _.label++; return { value: op[1], done: false };\r\n                    case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                    case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                    default:\r\n                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                        if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                        if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                        if (t[2]) _.ops.pop();\r\n                        _.trys.pop(); continue;\r\n                }\r\n                op = body.call(thisArg, _);\r\n            } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n            if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n        }\r\n    };\r\n\r\n    __exportStar = function (m, exports) {\r\n        for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n    };\r\n\r\n    __values = function (o) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n        if (m) return m.call(o);\r\n        return {\r\n            next: function () {\r\n                if (o && i >= o.length) o = void 0;\r\n                return { value: o && o[i++], done: !o };\r\n            }\r\n        };\r\n    };\r\n\r\n    __read = function (o, n) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n        if (!m) return o;\r\n        var i = m.call(o), r, ar = [], e;\r\n        try {\r\n            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n        }\r\n        catch (error) { e = { error: error }; }\r\n        finally {\r\n            try {\r\n                if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n            }\r\n            finally { if (e) throw e.error; }\r\n        }\r\n        return ar;\r\n    };\r\n\r\n    __spread = function () {\r\n        for (var ar = [], i = 0; i < arguments.length; i++)\r\n            ar = ar.concat(__read(arguments[i]));\r\n        return ar;\r\n    };\r\n\r\n    __await = function (v) {\r\n        return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n    };\r\n\r\n    __asyncGenerator = function (thisArg, _arguments, generator) {\r\n        if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n        var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n        return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n        function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n        function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n        function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\r\n        function fulfill(value) { resume(\"next\", value); }\r\n        function reject(value) { resume(\"throw\", value); }\r\n        function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n    };\r\n\r\n    __asyncDelegator = function (o) {\r\n        var i, p;\r\n        return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n        function verb(n, f) { if (o[n]) i[n] = function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; }; }\r\n    };\r\n\r\n    __asyncValues = function (o) {\r\n        if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n        var m = o[Symbol.asyncIterator];\r\n        return m ? m.call(o) : typeof __values === \"function\" ? __values(o) : o[Symbol.iterator]();\r\n    };\r\n\r\n    exporter(\"__extends\", __extends);\r\n    exporter(\"__assign\", __assign);\r\n    exporter(\"__rest\", __rest);\r\n    exporter(\"__decorate\", __decorate);\r\n    exporter(\"__param\", __param);\r\n    exporter(\"__metadata\", __metadata);\r\n    exporter(\"__awaiter\", __awaiter);\r\n    exporter(\"__generator\", __generator);\r\n    exporter(\"__exportStar\", __exportStar);\r\n    exporter(\"__values\", __values);\r\n    exporter(\"__read\", __read);\r\n    exporter(\"__spread\", __spread);\r\n    exporter(\"__await\", __await);\r\n    exporter(\"__asyncGenerator\", __asyncGenerator);\r\n    exporter(\"__asyncDelegator\", __asyncDelegator);\r\n    exporter(\"__asyncValues\", __asyncValues);\r\n});","/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing. The function also has a property 'clear' \n * that is a function which will clear the timer to prevent previously scheduled executions. \n *\n * @source underscore.js\n * @see http://unscriptable.com/2009/03/20/debouncing-javascript-methods/\n * @param {Function} function to wrap\n * @param {Number} timeout in ms (`100`)\n * @param {Boolean} whether to execute at the beginning (`false`)\n * @api public\n */\n\nmodule.exports = function debounce(func, wait, immediate){\n  var timeout, args, context, timestamp, result;\n  if (null == wait) wait = 100;\n\n  function later() {\n    var last = Date.now() - timestamp;\n\n    if (last < wait && last >= 0) {\n      timeout = setTimeout(later, wait - last);\n    } else {\n      timeout = null;\n      if (!immediate) {\n        result = func.apply(context, args);\n        context = args = null;\n      }\n    }\n  };\n\n  var debounced = function(){\n    context = this;\n    args = arguments;\n    timestamp = Date.now();\n    var callNow = immediate && !timeout;\n    if (!timeout) timeout = setTimeout(later, wait);\n    if (callNow) {\n      result = func.apply(context, args);\n      context = args = null;\n    }\n\n    return result;\n  };\n\n  debounced.clear = function() {\n    if (timeout) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n\n  return debounced;\n};\n","export interface IStringMap { [key: string]: string; }\n\nexport const getURLQueryParams = (): IStringMap => {\n    const params: IStringMap = {};\n\n    let query = window.location.search;\n    if (query && query.length) {\n        query = query.substring(1);\n        const keyParams = query.split(\"&\");\n        keyParams.forEach((keyParam) => {\n            const keyVal = keyParam.split(\"=\");\n            if (keyVal.length > 1) {\n                params[keyVal[0]] = decodeURIComponent(keyVal[1]);\n            }\n        });\n    }\n\n    return params;\n};\n","import debounce = require(\"debounce\");\n// import * as debounce from \"debounce\";\n// import { debounce } from \"debounce\";\n\nexport function startNavigatorExperiment(publicationJsonUrl: string) {\n\n    document.body.style.backgroundColor = \"silver\";\n\n    const h1 = document.querySelector(\"html > body > h1\");\n    if (h1) {\n        (h1 as HTMLElement).style.color = \"green\";\n    }\n\n    // const readerChrome = document.getElementById(\"reader_chrome\");\n    const readerControls = document.getElementById(\"reader_controls\");\n\n    const showControlsButton = document.getElementById(\"showControlsButton\");\n    if (showControlsButton) {\n        showControlsButton.style.display = \"block\";\n        showControlsButton.addEventListener(\"click\", (_event) => {\n            if (readerControls) {\n                readerControls.style.display = \"block\";\n            }\n            const hideControlsButt = document.getElementById(\"hideControlsButton\");\n            if (hideControlsButt) {\n                hideControlsButt.style.display = \"block \";\n            }\n        });\n    }\n\n    const webview1 = document.createElement(\"webview\");\n    webview1.setAttribute(\"id\", \"webview1\");\n    webview1.setAttribute(\"webpreferences\",\n        \"nodeIntegration=0, nodeIntegrationInWorker=0, sandbox=0, javascript=1, \" +\n        \"contextIsolation=0, webSecurity=1, allowRunningInsecureContent=0\");\n    webview1.setAttribute(\"partition\", \"persist:publicationwebview\");\n    webview1.setAttribute(\"httpreferrer\", publicationJsonUrl);\n    webview1.setAttribute(\"preload\", \"./preload.js\");\n    // webview.setAttribute(\"src\", \"dummy\");\n    // webview1.style.visibility = \"hidden\";\n    webview1.setAttribute(\"disableguestresize\", \"\");\n    window.addEventListener(\"resize\", debounce(() => {\n\n        // webview.offsetWidth == full including borders\n        // webview.scrollWidth == webview.clientWidth == without borders\n\n        // const computedStyle = window.getComputedStyle(webview1);\n        // console.log(parseInt(computedStyle.width as string, 10));\n        // console.log(parseInt(computedStyle.height as string, 10));\n\n        const width = webview1.clientWidth;\n        const height = webview1.clientHeight;\n\n        const wc = webview1.getWebContents();\n        if (wc && width && height) {\n            wc.setSize({\n                normal: {\n                    height,\n                    width,\n                },\n            });\n        }\n    }, 200));\n    webview1.addEventListener(\"ipc-message\", (event) => {\n        console.log(\"webview1 ipc-message\");\n        console.log(event.channel);\n        if (event.channel === \"readium\") {\n            console.log(event.args);\n        }\n    });\n    webview1.addEventListener(\"dom-ready\", () => {\n        // webview1.openDevTools();\n\n        const cssButtonN1 = document.getElementById(\"cssButtonInject\");\n        if (!cssButtonN1) {\n            return;\n        }\n        cssButtonN1.removeAttribute(\"disabled\");\n\n        const cssButtonN2 = document.getElementById(\"cssButtonReset\");\n        if (!cssButtonN2) {\n            return;\n        }\n        cssButtonN2.removeAttribute(\"disabled\");\n\n        // webview1.style.visibility = \"visible\";\n    });\n    const publicationViewport = document.getElementById(\"publication_viewport\");\n    if (publicationViewport) {\n        publicationViewport.appendChild(webview1);\n    }\n\n    const hideControlsButton = document.getElementById(\"hideControlsButton\");\n    if (hideControlsButton) {\n        hideControlsButton.addEventListener(\"click\", (_event) => {\n            if (readerControls) {\n                readerControls.style.display = \"none\";\n            }\n            hideControlsButton.style.display = \"none\";\n        });\n    }\n\n    const cssButton1 = document.getElementById(\"cssButtonInject\");\n    if (cssButton1) {\n        cssButton1.addEventListener(\"click\", (_event) => {\n            const jsonMsg = { injectCSS: \"yes\", setCSS: \"ok\" };\n            webview1.send(\"readium\", JSON.stringify(jsonMsg)); // .getWebContents()\n        });\n    }\n\n    const cssButton2 = document.getElementById(\"cssButtonReset\");\n    if (cssButton2) {\n        cssButton2.addEventListener(\"click\", (_event) => {\n            const jsonMsg = { injectCSS: \"rollback\", setCSS: \"rollback\" };\n            webview1.send(\"readium\", JSON.stringify(jsonMsg)); // .getWebContents()\n        });\n    }\n\n    // tslint:disable-next-line:no-floating-promises\n    (async () => {\n\n        // try {\n        //     // hacky :) (just for testing);\n        //     // (initializes the LCP pass)\n        //     await fetch(publicationJsonUrl.replace(\"/pub/\",\n        //         \"/pub/*-\" +\n        //         \"ZWM0ZjJkYmIzYjE0MDA5NTU1MGM5YWZiYmI2OWI1ZDZmZDllODE0YjlkYTgyZmFkMGIzNGU5ZmNiZTU2ZjFjYg\" +\n        //         \"==-*\"));\n        // } catch (e) {\n        //     console.log(e);\n        // }\n\n        let response: Response | undefined;\n        try {\n            response = await fetch(publicationJsonUrl);\n        } catch (e) {\n            console.log(e);\n        }\n        if (!response) {\n            return;\n        }\n        if (!response.ok) {\n            console.log(\"BAD RESPONSE?!\");\n        }\n        response.headers.forEach((arg0: any, arg1: any) => {\n            console.log(arg0 + \" => \" + arg1);\n        });\n\n        let publicationJson: any | undefined;\n        try {\n            publicationJson = await response.json();\n        } catch (e) {\n            console.log(e);\n        }\n        if (!publicationJson) {\n            return;\n        }\n        console.log(publicationJson);\n\n        if (publicationJson.spine) {\n            const readerControlsSpine = document.getElementById(\"reader_controls_SPINE\");\n            publicationJson.spine.forEach((spineItem: any) => {\n                const spineItemLink = document.createElement(\"a\");\n                const spineItemLinkHref = publicationJsonUrl + \"/../\" + spineItem.href;\n                spineItemLink.setAttribute(\"href\", spineItemLinkHref);\n                spineItemLink.addEventListener(\"click\", (event) => {\n                    event.preventDefault();\n\n                    webview1.setAttribute(\"src\", spineItemLinkHref);\n                    // webview1.getWebContents().loadURL(spineItemLinkHref, { extraHeaders: \"pragma: no-cache\\n\" });\n                    // webview1.loadURL(spineItemLinkHref, { extraHeaders: \"pragma: no-cache\\n\" });\n                });\n                spineItemLink.appendChild(document.createTextNode(spineItem.href));\n                if (readerControlsSpine) {\n                    readerControlsSpine.appendChild(spineItemLink);\n                    readerControlsSpine.appendChild(document.createElement(\"br\"));\n                }\n            });\n        }\n\n        if (publicationJson.toc && publicationJson.toc.length) {\n            const readerControlsToc = document.getElementById(\"reader_controls_TOC\");\n            if (readerControlsToc) {\n                appendToc(publicationJson.toc, readerControlsToc, publicationJsonUrl, webview1);\n            }\n        }\n        if (publicationJson[\"page-list\"] && publicationJson[\"page-list\"].length) {\n            const readerControlsPageList = document.getElementById(\"reader_controls_PAGELIST\");\n            if (readerControlsPageList) {\n                appendToc(publicationJson[\"page-list\"], readerControlsPageList, publicationJsonUrl, webview1);\n            }\n        }\n\n        const readerControlsLandmarks = document.getElementById(\"reader_controls_LANDMARKS\");\n        if (readerControlsLandmarks) {\n            if (publicationJson.landmarks && publicationJson.landmarks.length) {\n                appendToc(publicationJson.landmarks, readerControlsLandmarks, publicationJsonUrl, webview1);\n            }\n            if (publicationJson.lot && publicationJson.lot.length) {\n                readerControlsLandmarks.appendChild(document.createElement(\"hr\"));\n                appendToc(publicationJson.lot, readerControlsLandmarks, publicationJsonUrl, webview1);\n            }\n            if (publicationJson.loa && publicationJson.loa.length) {\n                readerControlsLandmarks.appendChild(document.createElement(\"hr\"));\n                appendToc(publicationJson.loa, readerControlsLandmarks, publicationJsonUrl, webview1);\n            }\n            if (publicationJson.loi && publicationJson.loi.length) {\n                readerControlsLandmarks.appendChild(document.createElement(\"hr\"));\n                appendToc(publicationJson.loi, readerControlsLandmarks, publicationJsonUrl, webview1);\n            }\n            if (publicationJson.lov && publicationJson.lov.length) {\n                readerControlsLandmarks.appendChild(document.createElement(\"hr\"));\n                appendToc(publicationJson.lov, readerControlsLandmarks, publicationJsonUrl, webview1);\n            }\n        }\n    })();\n    //     const spineItemUrl = publicationJsonUrl + \"/../\" + publicationJson.spine[0].href;\n    //     console.log(spineItemUrl);\n    //     webview1.setAttribute(\"src\", spineItemUrl);\n\n    // const a = document.querySelector(\"html > body > a\");\n    // a.click();\n}\n\nfunction appendToc(json: any, anchor: HTMLElement, publicationJsonUrl: string, webview1: HTMLElement) {\n\n    const ul = document.createElement(\"ul\");\n    json.forEach((tocLinkJson: any) => {\n        const li = document.createElement(\"li\");\n\n        if (!tocLinkJson.title) {\n            tocLinkJson.title = \"xxx\";\n        }\n\n        if (tocLinkJson.href) {\n            const tocLink = document.createElement(\"a\");\n            const tocLinkHref = publicationJsonUrl + \"/../\" + tocLinkJson.href;\n            tocLink.setAttribute(\"href\", tocLinkHref);\n            tocLink.addEventListener(\"click\", (event) => {\n                event.preventDefault();\n\n                webview1.setAttribute(\"src\", tocLinkHref);\n                // webview1.getWebContents().loadURL(tocLinkHref, { extraHeaders: \"pragma: no-cache\\n\" });\n                // webview1.loadURL(tocLinkHref, { extraHeaders: \"pragma: no-cache\\n\" });\n            });\n            tocLink.appendChild(document.createTextNode(tocLinkJson.title));\n            li.appendChild(tocLink);\n\n            const br = document.createElement(\"br\");\n            li.appendChild(br);\n\n            const tocHeading = document.createElement(\"span\");\n            tocHeading.appendChild(document.createTextNode(tocLinkJson.href));\n            li.appendChild(tocHeading);\n        } else {\n            const tocHeading = document.createElement(\"span\");\n            tocHeading.appendChild(document.createTextNode(tocLinkJson.title));\n            li.appendChild(tocHeading);\n        }\n\n        ul.appendChild(li);\n\n        if (tocLinkJson.children && tocLinkJson.children.length) {\n            appendToc(tocLinkJson.children, li, publicationJsonUrl, webview1);\n        }\n    });\n\n    anchor.appendChild(ul);\n}\n","import { ipcRenderer } from \"electron\";\nimport { startNavigatorExperiment } from \"./index_navigator\";\nimport { getURLQueryParams } from \"./querystring\";\n\n// import { startServiceWorkerExperiment } from \"./sw/index_service-worker\";\n\nconsole.log(\"INDEX\");\n\nconsole.log(window.location);\nconsole.log(document.baseURI);\nconsole.log(document.URL);\n\nconst queryParams = getURLQueryParams();\n\n// tslint:disable-next-line:no-string-literal\nconst publicationJsonUrl = queryParams[\"pub\"];\n\nconsole.log(\" (((( publicationJsonUrl )))) \" + publicationJsonUrl);\n\n// tslint:disable-next-line:no-string-literal\nconst lcpHint = queryParams[\"lcpHint\"];\n\nwindow.onerror = (err) => {\n    console.log(\"Error\", err);\n};\n\nipcRenderer.on(\"tryLcpPass\", (_event: any, okay: boolean, message: string) => {\n    console.log(okay);\n    console.log(message);\n\n    const lcpPassInput = document.getElementById(\"lcpPassInput\");\n    if (!lcpPassInput) {\n        return;\n    }\n\n    (lcpPassInput as HTMLInputElement).value = message;\n\n    if (okay) {\n        setTimeout(() => {\n            const lcpPassForm = document.getElementById(\"lcpPassForm\");\n            if (!lcpPassForm) {\n                return;\n            }\n            lcpPassForm.style.display = \"none\";\n        }, 1000);\n    }\n});\n\nwindow.addEventListener(\"DOMContentLoaded\", () => {\n\n    const pathBase64 = publicationJsonUrl.replace(/.*\\/pub\\/(.*)\\/manifest.json/, \"$1\");\n    console.log(pathBase64);\n    const pathDecoded = window.atob(pathBase64);\n    console.log(pathDecoded);\n    const pathFileName = pathDecoded.substr(pathDecoded.lastIndexOf(\"/\") + 1, pathDecoded.length - 1);\n\n    const h1 = document.querySelector(\"html > body > h1 > span\");\n    if (h1) {\n        (h1 as HTMLElement).textContent = pathFileName;\n    }\n\n    const lcpPassForm = document.getElementById(\"lcpPassForm\");\n    if (!lcpPassForm) {\n        return;\n    }\n    const lcpPassInput = document.getElementById(\"lcpPassInput\");\n    if (!lcpPassInput) {\n        return;\n    }\n    if (lcpHint) {\n        (lcpPassInput as HTMLInputElement).value = lcpHint;\n        lcpPassForm.style.display = \"inline-block\";\n        // lcpPassForm.onsubmit\n        lcpPassForm.addEventListener(\"submit\", (evt) => {\n            if (evt) {\n                evt.preventDefault();\n            }\n            const lcpPass = (lcpPassInput as HTMLInputElement).value;\n            ipcRenderer.send(\"tryLcpPass\", pathDecoded, lcpPass);\n            return false;\n        });\n    }\n\n    const buttStart = document.getElementById(\"buttonStart\");\n    if (!buttStart) {\n        return;\n    }\n    buttStart.addEventListener(\"click\", () => {\n        buttStart.setAttribute(\"disabled\", \"\");\n        buttStart.style.display = \"none\";\n        // startServiceWorkerExperiment(publicationJsonUrl);\n        startNavigatorExperiment(publicationJsonUrl);\n    });\n\n    const buttonDebug = document.getElementById(\"buttonDebug\");\n    if (!buttonDebug) {\n        return;\n    }\n    buttonDebug.addEventListener(\"click\", () => {\n        if (document.documentElement.classList.contains(\"debug\")) {\n            document.documentElement.classList.remove(\"debug\");\n        } else {\n            document.documentElement.classList.add(\"debug\");\n        }\n    });\n\n    const buttonDevTools = document.getElementById(\"buttonDevTools\");\n    if (!buttonDevTools) {\n        return;\n    }\n    buttonDevTools.addEventListener(\"click\", () => {\n        ipcRenderer.send(\"devtools\", \"test\");\n    });\n});\n","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})"],"names":[],"mappings":"AKAA;;;ADAA;AACA;AACA;AAIA;AAEA;AACA;AACA;AAEA;AAGA;AAEA;AAGA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;ADjHA;AAIA;AAEA;AAEA;AACA;AACA;AACA;AAGA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAGA;AACA;AASA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AAaA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAOA;AA1NA;AA4NA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAGA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AACA;;;;;AD1Qa;AACb;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;;ADlBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ADxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}