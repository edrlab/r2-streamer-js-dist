{"version":3,"file":"self-signed.js","sourceRoot":"","sources":["../../../../src/utils/self-signed.ts"],"names":[],"mappings":";;AAAA,yCAAyC;AACzC,6BAA6B;AAetB,KAAK;IACR,MAAM,CAAC,IAAI,OAAO,CAAkB,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;QACpD,MAAM,IAAI,GAAG;YACT,SAAS,EAAE,QAAQ;YACnB,iBAAiB,EAAE,IAAI;YACvB,mBAAmB,EAAE,oBAAoB;YACzC,IAAI,EAAE,EAAE;YACR,UAAU,EAAE,CAAC;oBACT,QAAQ,EAAE,CAAC;4BACP,IAAI,EAAE,CAAC;4BACP,KAAK,EAAE,WAAW;yBACrB,CAAC;oBACF,IAAI,EAAE,gBAAgB;iBACzB,CAAC;SACL,CAAC;QACF,MAAM,IAAI,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC;QACvB,MAAM,UAAU,GAAG,CAAC,EAAE,IAAI,EAAE,YAAY,EAAE,KAAK,EAAE,qBAAqB,GAAG,IAAI,EAAE,CAAC,CAAC;QAEjF,UAAU,CAAC,QAAQ,CAAC,UAAU,EAAE,IAAI,EAAE,CAAC,GAAQ,EAAE,IAAS,EAAE,EAAE;YAC1D,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;gBACN,MAAM,CAAC,GAAG,CAAC,CAAC;gBACZ,MAAM,CAAC;YACX,CAAC;YACA,IAAwB,CAAC,QAAQ,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC;YAC9C,IAAwB,CAAC,QAAQ,GAAG,IAAI,CAAC;YAC1C,OAAO,CAAC,IAAuB,CAAC,CAAC;QACrC,CAAC,CAAC,CAAC;IACP,CAAC,CAAC,CAAC;AACP,CAAC;AA5BD,wDA4BC","sourcesContent":["import * as selfsigned from \"selfsigned\";\nimport * as uuid from \"uuid\";\n\nexport interface CertificateData {\n    trustKey: string;\n    trustVal: string;\n\n    clientprivate?: string;\n    clientpublic?: string;\n    clientcert?: string;\n\n    private?: string; // https.ServerOptions.key\n    public?: string;\n    cert?: string; // https.ServerOptions.cert\n}\n\nexport async function generateSelfSignedData(): Promise<CertificateData> {\n    return new Promise<CertificateData>((resolve, reject) => {\n        const opts = {\n            algorithm: \"sha256\",\n            clientCertificate: true,\n            clientCertificateCN: \"R2 insecure client\",\n            days: 30,\n            extensions: [{\n                altNames: [{\n                    type: 2, // DNSName\n                    value: \"localhost\",\n                }],\n                name: \"subjectAltName\",\n            }],\n        };\n        const rand = uuid.v4();\n        const attributes = [{ name: \"commonName\", value: \"R2 insecure server \" + rand }];\n\n        selfsigned.generate(attributes, opts, (err: any, keys: any) => {\n            if (err) {\n                reject(err);\n                return;\n            }\n            (keys as CertificateData).trustKey = uuid.v4();\n            (keys as CertificateData).trustVal = rand;\n            resolve(keys as CertificateData);\n        });\n    });\n}\n"]}