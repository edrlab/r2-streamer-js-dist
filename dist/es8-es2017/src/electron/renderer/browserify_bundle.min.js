!function e(t,n,o){function l(r,s){if(!n[r]){if(!t[r]){var d="function"==typeof require&&require;if(!s&&d)return d(r,!0);if(c)return c(r,!0);var i=new Error("Cannot find module '"+r+"'");throw i.code="MODULE_NOT_FOUND",i}var a=n[r]={exports:{}};t[r][0].call(a.exports,function(e){var n=t[r][1][e];return l(n||e)},a,a.exports,e,t,n,o)}return n[r].exports}for(var c="function"==typeof require&&require,r=0;r<o.length;r++)l(o[r]);return l}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const o=e("electron"),l=e("./index_navigator"),c=e("./querystring");console.log("INDEX"),console.log(window.location),console.log(document.baseURI),console.log(document.URL);const r=c.getURLQueryParams(),s=r.pub;console.log(" (((( publicationJsonUrl )))) "+s);const d=r.lcpHint;window.onerror=(e=>{console.log("Error",e)}),o.ipcRenderer.on("tryLcpPass",(e,t,n)=>{console.log(t),console.log(n);const o=document.getElementById("lcpPassInput");o&&(o.value=n,t&&setTimeout(()=>{const e=document.getElementById("lcpPassForm");e&&(e.style.display="none")},1e3))}),window.addEventListener("DOMContentLoaded",()=>{const e=s.replace(/.*\/pub\/(.*)\/manifest.json/,"$1");console.log(e);const t=window.atob(e);console.log(t);const n=t.substr(t.lastIndexOf("/")+1,t.length-1),c=document.querySelector("html > body > h1 > span");c&&(c.textContent=n);const r=document.getElementById("lcpPassForm");if(!r)return;const i=document.getElementById("lcpPassInput");if(!i)return;d&&(i.value=d,r.style.display="inline-block",r.addEventListener("submit",e=>{e&&e.preventDefault();const n=i.value;return o.ipcRenderer.send("tryLcpPass",t,n),!1}));const a=document.getElementById("buttonStart");if(!a)return;a.addEventListener("click",()=>{a.setAttribute("disabled",""),a.style.display="none",l.startNavigatorExperiment(s)});const u=document.getElementById("buttonDebug");if(!u)return;u.addEventListener("click",()=>{document.documentElement.classList.contains("debug")?document.documentElement.classList.remove("debug"):document.documentElement.classList.add("debug")});const m=document.getElementById("buttonDevTools");m&&m.addEventListener("click",()=>{o.ipcRenderer.send("devtools","test")})})},{"./index_navigator":2,"./querystring":3,electron:void 0}],2:[function(e,t,n){"use strict";function o(e,t,n,l){const c=document.createElement("ul");e.forEach(e=>{const t=document.createElement("li");if(e.title||(e.title="xxx"),e.href){const o=document.createElement("a"),c=n+"/../"+e.href;o.setAttribute("href",c),o.addEventListener("click",e=>{e.preventDefault(),l.setAttribute("src",c)}),o.appendChild(document.createTextNode(e.title)),t.appendChild(o);const r=document.createElement("br");t.appendChild(r);const s=document.createElement("span");s.appendChild(document.createTextNode(e.href)),t.appendChild(s)}else{const n=document.createElement("span");n.appendChild(document.createTextNode(e.title)),t.appendChild(n)}c.appendChild(t),e.children&&e.children.length&&o(e.children,t,n,l)}),t.appendChild(c)}Object.defineProperty(n,"__esModule",{value:!0});const l=e("debounce");n.startNavigatorExperiment=function(e){document.body.style.backgroundColor="silver";const t=document.querySelector("html > body > h1");t&&(t.style.color="green");const n=document.getElementById("reader_controls"),c=document.getElementById("showControlsButton");c&&(c.style.display="block",c.addEventListener("click",e=>{n&&(n.style.display="block");const t=document.getElementById("hideControlsButton");t&&(t.style.display="block ")}));const r=document.createElement("webview");r.setAttribute("id","webview1"),r.setAttribute("webpreferences","nodeIntegration=0, nodeIntegrationInWorker=0, sandbox=0, javascript=1, contextIsolation=0, webSecurity=1, allowRunningInsecureContent=0"),r.setAttribute("partition","persist:publicationwebview"),r.setAttribute("httpreferrer",e),r.setAttribute("preload","./preload.js"),r.setAttribute("disableguestresize",""),window.addEventListener("resize",l(()=>{const e=r.clientWidth,t=r.clientHeight,n=r.getWebContents();n&&e&&t&&n.setSize({normal:{height:t,width:e}})},200)),r.addEventListener("ipc-message",e=>{console.log("webview1 ipc-message"),console.log(e.channel),"readium"===e.channel&&console.log(e.args)}),r.addEventListener("dom-ready",()=>{const e=document.getElementById("cssButtonInject");if(!e)return;e.removeAttribute("disabled");const t=document.getElementById("cssButtonReset");t&&t.removeAttribute("disabled")});const s=document.getElementById("publication_viewport");s&&s.appendChild(r);const d=document.getElementById("hideControlsButton");d&&d.addEventListener("click",e=>{n&&(n.style.display="none"),d.style.display="none"});const i=document.getElementById("cssButtonInject");i&&i.addEventListener("click",e=>{const t={injectCSS:"yes",setCSS:"ok"};r.send("readium",JSON.stringify(t))});const a=document.getElementById("cssButtonReset");a&&a.addEventListener("click",e=>{const t={injectCSS:"rollback",setCSS:"rollback"};r.send("readium",JSON.stringify(t))}),(async()=>{let t;try{t=await fetch(e)}catch(e){console.log(e)}if(!t)return;t.ok||console.log("BAD RESPONSE?!"),t.headers.forEach((e,t)=>{console.log(e+" => "+t)});let n;try{n=await t.json()}catch(e){console.log(e)}if(!n)return;if(console.log(n),n.spine){const t=document.getElementById("reader_controls_SPINE");n.spine.forEach(n=>{const o=document.createElement("a"),l=e+"/../"+n.href;o.setAttribute("href",l),o.addEventListener("click",e=>{e.preventDefault(),r.setAttribute("src",l)}),o.appendChild(document.createTextNode(n.href)),t&&(t.appendChild(o),t.appendChild(document.createElement("br")))})}if(n.toc&&n.toc.length){const t=document.getElementById("reader_controls_TOC");t&&o(n.toc,t,e,r)}if(n["page-list"]&&n["page-list"].length){const t=document.getElementById("reader_controls_PAGELIST");t&&o(n["page-list"],t,e,r)}const l=document.getElementById("reader_controls_LANDMARKS");l&&(n.landmarks&&n.landmarks.length&&o(n.landmarks,l,e,r),n.lot&&n.lot.length&&(l.appendChild(document.createElement("hr")),o(n.lot,l,e,r)),n.loa&&n.loa.length&&(l.appendChild(document.createElement("hr")),o(n.loa,l,e,r)),n.loi&&n.loi.length&&(l.appendChild(document.createElement("hr")),o(n.loi,l,e,r)),n.lov&&n.lov.length&&(l.appendChild(document.createElement("hr")),o(n.lov,l,e,r)))})()}},{debounce:4}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getURLQueryParams=(()=>{const e={};let t=window.location.search;return t&&t.length&&(t=t.substring(1)).split("&").forEach(t=>{const n=t.split("=");n.length>1&&(e[n[0]]=decodeURIComponent(n[1]))}),e})},{}],4:[function(e,t,n){t.exports=function(e,t,n){function o(){var i=Date.now()-s;i<t&&i>=0?l=setTimeout(o,t-i):(l=null,n||(d=e.apply(r,c),r=c=null))}var l,c,r,s,d;null==t&&(t=100);var i=function(){r=this,c=arguments,s=Date.now();var i=n&&!l;return l||(l=setTimeout(o,t)),i&&(d=e.apply(r,c),r=c=null),d};return i.clear=function(){l&&(clearTimeout(l),l=null)},i}},{}]},{},[1]);
//# sourceMappingURL=browserify_bundle.min.js.map