{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../../src/electron/renderer/index.ts"],"names":[],"mappings":"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","sourcesContent":["import debounce = require(\"debounce\");\nimport { ipcRenderer } from \"electron\";\nimport { shell } from \"electron\";\nimport { R2_EVENT_LINK, R2_EVENT_READIUMCSS, R2_EVENT_TRY_LCP_PASS, R2_EVENT_TRY_LCP_PASS_RES } from \"../common/events\";\nimport { R2_SESSION_WEBVIEW } from \"../common/sessions\";\nimport { getURLQueryParams } from \"./querystring\";\nimport { riotMountSpineList } from \"./riots/spinelist/index_\";\nimport { riotMountSpineListGroup } from \"./riots/spinelistgroup/index_\";\n\n// import { riotMountMyTag } from \"./riots/mytag/index_\";\n// import { RiotMixinWithOpts } from \"./riots/riot_mixin_EventTracer\";\n// import { startServiceWorkerExperiment } from \"./sw/index_service-worker\";\n\nconsole.log(\"INDEX\");\n\nconsole.log(window.location);\nconsole.log(document.baseURI);\nconsole.log(document.URL);\n\nconst queryParams = getURLQueryParams();\n\n// tslint:disable-next-line:no-string-literal\nconst publicationJsonUrl = queryParams[\"pub\"];\n\nconsole.log(\" (((( publicationJsonUrl )))) \" + publicationJsonUrl);\n\nconst pathBase64 = publicationJsonUrl.replace(/.*\\/pub\\/(.*)\\/manifest.json/, \"$1\");\nconsole.log(pathBase64);\nconst pathDecoded = window.atob(pathBase64);\nconsole.log(pathDecoded);\nconst pathFileName = pathDecoded.substr(\n    pathDecoded.replace(/\\\\/g, \"/\").lastIndexOf(\"/\") + 1,\n    pathDecoded.length - 1);\n\n// tslint:disable-next-line:no-string-literal\nconst lcpHint = queryParams[\"lcpHint\"];\n\nconst basicLinkTitles = true;\n\nlet snackBar: any;\nlet drawer: any;\n\nexport function handleLink(href: string) {\n    console.log(href);\n    const prefix = publicationJsonUrl.replace(\"manifest.json\", \"\");\n    if (href.startsWith(prefix)) {\n        if (drawer.open) {\n            drawer.open = false;\n            setTimeout(() => {\n                loadLink(href, href.replace(prefix, \"\"), publicationJsonUrl);\n            }, 500);\n        } else {\n            loadLink(href, href.replace(prefix, \"\"), publicationJsonUrl);\n        }\n    } else {\n        shell.openExternal(href);\n    }\n}\n\nwindow.onerror = (err) => {\n    console.log(\"Error\", err);\n};\n\nipcRenderer.on(R2_EVENT_LINK, (_event: any, href: string) => {\n    console.log(\"R2_EVENT_LINK\");\n    console.log(href);\n    handleLink(href);\n});\n\nipcRenderer.on(R2_EVENT_TRY_LCP_PASS_RES, (_event: any, okay: boolean, msg: string) => {\n    console.log(\"R2_EVENT_TRY_LCP_PASS_RES\");\n    console.log(okay);\n    console.log(msg);\n\n    if (!okay) {\n        showLcpDialog(msg);\n        return;\n    }\n\n    const message = \"Correct publication passphrase.\";\n    const data = {\n        actionHandler: () => {\n            console.log(\"SnackBar OK\");\n        },\n        actionOnBottom: false,\n        actionText: \"OK\",\n        message,\n        multiline: false,\n        timeout: 2000,\n    };\n    snackBar.show(data);\n    startNavigatorExperiment();\n\n    // const lcpPassMessage = document.getElementById(\"lcpPassMessage\");\n    // const lcpPassForm = document.getElementById(\"lcpPassForm\");\n    // if (!lcpPassMessage || !lcpPassForm) {\n    //     return;\n    // }\n\n    // (lcpPassMessage as HTMLInputElement).textContent = message;\n\n    // if (okay) {\n    //     setTimeout(() => {\n    //         lcpPassForm.style.display = \"none\";\n    //     }, 1000);\n    // }\n});\n\nlet lcpDialog: any;\n\nfunction showLcpDialog(message?: string) {\n\n    // dialog.lastFocusedTarget = evt.target;\n\n    // const lcpPassForm = document.getElementById(\"lcpPassForm\");\n    const lcpPassHint = document.getElementById(\"lcpPassHint\");\n    (lcpPassHint as HTMLInputElement).textContent = lcpHint;\n\n    if (message) {\n        const lcpPassMessage = document.getElementById(\"lcpPassMessage\");\n        (lcpPassMessage as HTMLInputElement).textContent = message;\n    }\n\n    lcpDialog.show();\n    setTimeout(() => {\n        const lcpPassInput = document.getElementById(\"lcpPassInput\");\n        if (lcpPassInput) {\n            lcpPassInput.focus();\n        }\n    }, 1000);\n}\n\nwindow.addEventListener(\"DOMContentLoaded\", () => {\n\n    setTimeout(() => {\n        // material-components-web\n        (window as any).mdc.autoInit();\n    }, 500);\n\n    // const tag = riot.mount(\"*\");\n    // riotMountMyTag({ opt1: \"val1\" });\n\n    window.document.title = \"Readium2 [ \" + pathFileName + \"]\";\n\n    const h1 = document.getElementById(\"pubTitle\");\n    if (h1) {\n        (h1 as HTMLElement).textContent = pathFileName;\n    }\n\n    const snackBarElem = document.getElementById(\"snackbar\");\n    snackBar = new (window as any).mdc.snackbar.MDCSnackbar(snackBarElem);\n    snackBar.dismissesOnAction = true;\n\n    const drawerElement = document.getElementById(\"drawer\");\n    drawer = new (window as any).mdc.drawer.MDCTemporaryDrawer(drawerElement);\n    const drawerButton = document.getElementById(\"drawerButton\");\n    if (drawerButton) {\n        drawerButton.addEventListener(\"click\", () => {\n            drawer.open = true;\n        });\n    }\n    if (drawerElement) {\n        drawerElement.addEventListener(\"MDCTemporaryDrawer:open\", () => {\n            console.log(\"MDCTemporaryDrawer:open\");\n        });\n        drawerElement.addEventListener(\"MDCTemporaryDrawer:close\", () => {\n            console.log(\"MDCTemporaryDrawer:close\");\n        });\n    }\n\n    const selectElement = document.getElementById(\"nav-select\");\n    const navSelector = new (window as any).mdc.select.MDCSelect(selectElement);\n    navSelector.listen(\"MDCSelect:change\", (ev: any) => {\n        console.log(\"MDCSelect:change\");\n        console.log(ev);\n        console.log(ev.detail.selectedOptions[0].textContent);\n        console.log(ev.detail.selectedIndex);\n        console.log(ev.detail.value);\n\n        const activePanel = document.querySelector(\".tabPanel.active\");\n        if (activePanel) {\n            activePanel.classList.remove(\"active\");\n        }\n        const newActivePanel = document.querySelector(\".tabPanel:nth-child(\" + (ev.detail.selectedIndex + 1) + \")\");\n        if (newActivePanel) {\n            newActivePanel.classList.add(\"active\");\n        }\n    });\n\n    // const tabsElement = document.getElementById(\"tabs\");\n    // const tabs = new (window as any).mdc.tabs.MDCTabBarScroller(tabsElement);\n    // // tabs.tabBar.layout();\n    // tabs.tabBar.preventDefaultOnClick = true;\n    // tabs.tabBar.listen(\"MDCTabBar:change\", (ev: any) => {\n    //     console.log(\"MDCTabBar:change\");\n    //     console.log(ev.detail.activeTabIndex);\n    //     const activePanel = document.querySelector(\".tabPanel.active\");\n    //     if (activePanel) {\n    //         activePanel.classList.remove(\"active\");\n    //     }\n    //     const newActivePanel = document.querySelector(\".tabPanel:nth-child(\" + (ev.detail.activeTabIndex + 1) + \")\");\n    //     if (newActivePanel) {\n    //         newActivePanel.classList.add(\"active\");\n    //     }\n    // });\n\n    const diagElem = document.querySelector(\"#lcpDialog\");\n    const lcpPassInput = document.getElementById(\"lcpPassInput\");\n    lcpDialog = new (window as any).mdc.dialog.MDCDialog(diagElem);\n    lcpDialog.listen(\"MDCDialog:accept\", () => {\n        console.log(\"MDCDialog:accept\");\n\n        const lcpPass = (lcpPassInput as HTMLInputElement).value;\n\n        ipcRenderer.send(R2_EVENT_TRY_LCP_PASS, pathDecoded, lcpPass);\n    });\n    lcpDialog.listen(\"MDCDialog:cancel\", () => {\n        console.log(\"MDCDialog:cancel\");\n\n        // ipcRenderer.send(R2_EVENT_TRY_LCP_PASS, pathDecoded, \"NILL\");\n        setTimeout(() => {\n            showLcpDialog();\n        }, 10);\n    });\n    if (lcpPassInput) {\n        lcpPassInput.addEventListener(\"keyup\", (ev) => {\n            if (ev.keyCode === 13) {\n                ev.preventDefault();\n                const lcpDialogAcceptButton = document.getElementById(\"lcpDialogAcceptButton\");\n                if (lcpDialogAcceptButton) {\n                    lcpDialogAcceptButton.click();\n                }\n            }\n        });\n    }\n\n    if (lcpHint) {\n        showLcpDialog();\n    } else {\n        startNavigatorExperiment();\n    }\n\n    // const buttonStart = document.getElementById(\"buttonStart\");\n    // if (buttonStart) {\n    //     buttonStart.addEventListener(\"click\", () => {\n    //         buttonStart.setAttribute(\"disabled\", \"\");\n    //         buttonStart.style.display = \"none\";\n    //         // startServiceWorkerExperiment(publicationJsonUrl);\n    //         startNavigatorExperiment(publicationJsonUrl);\n    //     });\n    // }\n\n    const buttonDebug = document.getElementById(\"buttonDebug\");\n    if (buttonDebug) {\n        buttonDebug.addEventListener(\"click\", () => {\n            if (document.documentElement.classList.contains(\"debug\")) {\n                document.documentElement.classList.remove(\"debug\");\n            } else {\n                document.documentElement.classList.add(\"debug\");\n            }\n        });\n    }\n\n    const buttonDark = document.getElementById(\"buttonDark\");\n    if (buttonDark) {\n        buttonDark.addEventListener(\"click\", () => {\n            if (document.body.classList.contains(\"mdc-theme--dark\")) {\n                document.body.classList.remove(\"mdc-theme--dark\");\n            } else {\n                document.body.classList.add(\"mdc-theme--dark\");\n            }\n        });\n    }\n\n    // const buttonDevTools = document.getElementById(\"buttonDevTools\");\n    // if (buttonDevTools) {\n    //     buttonDevTools.addEventListener(\"click\", () => {\n    //         ipcRenderer.send(R2_EVENT_DEVTOOLS, \"test\");\n    //     });\n    // }\n});\n\nconst _webviews: Electron.WebviewTag[] = [];\n\nfunction createWebView() {\n    const webview1 = document.createElement(\"webview\");\n    webview1.setAttribute(\"class\", \"singleFull\");\n    webview1.setAttribute(\"webpreferences\",\n        \"nodeIntegration=0, nodeIntegrationInWorker=0, sandbox=0, javascript=1, \" +\n        \"contextIsolation=0, webSecurity=1, allowRunningInsecureContent=0\");\n    webview1.setAttribute(\"partition\", R2_SESSION_WEBVIEW);\n    webview1.setAttribute(\"httpreferrer\", publicationJsonUrl);\n    webview1.setAttribute(\"preload\", \"./preload.js\");\n    // webview.setAttribute(\"src\", \"dummy\");\n    // webview1.style.visibility = \"hidden\";\n    webview1.setAttribute(\"disableguestresize\", \"\");\n\n    webview1.addEventListener(\"ipc-message\", (event) => {\n        console.log(\"webview1 ipc-message\");\n        console.log(event.channel);\n        if (event.channel === R2_EVENT_LINK) {\n            handleLink(event.args[0]);\n        }\n    });\n\n    webview1.addEventListener(\"dom-ready\", () => {\n        // webview1.openDevTools();\n        console.log(\"WEBVIEW DOM READY: \" + _webviews.length);\n\n        webview1.clearHistory();\n\n        const cssButtonN1 = document.getElementById(\"cssButtonInject\");\n        if (cssButtonN1) {\n            cssButtonN1.removeAttribute(\"disabled\");\n        }\n\n        const cssButtonN2 = document.getElementById(\"cssButtonReset\");\n        if (cssButtonN2) {\n            cssButtonN2.removeAttribute(\"disabled\");\n        }\n\n        // webview1.style.visibility = \"visible\";\n\n        // webview1.getWebContents().on(\"will-navigate\", (evt, url) => {\n        //     console.log(\"webview1.getWebContents().on('will-navigate'\");\n        //     console.log(evt);\n        //     console.log(url);\n        //     evt.preventDefault();\n        //     // webview1.stop();\n        //     shell.openExternal(url);\n        // });\n    });\n\n    // webview1.addEventListener(\"will-navigate\", (evt) => {\n    //     console.log(\"webview1.addEventListener('will-navigate'\");\n    //     console.log(evt);\n    //     console.log(evt.url);\n    //     // evt.preventDefault();\n    //     webview1.stop();\n    //     shell.openExternal(evt.url);\n    // });\n\n    return webview1;\n}\n\nwindow.addEventListener(\"resize\", debounce(() => {\n\n    _webviews.forEach((wv) => {\n\n        // webview.offsetWidth == full including borders\n        // webview.scrollWidth == webview.clientWidth == without borders\n\n        // const computedStyle = window.getComputedStyle(webview1);\n        // console.log(parseInt(computedStyle.width as string, 10));\n        // console.log(parseInt(computedStyle.height as string, 10));\n\n        const width = wv.clientWidth;\n        const height = wv.clientHeight;\n\n        const wc = wv.getWebContents();\n        if (wc && width && height) {\n            wc.setSize({\n                normal: {\n                    height,\n                    width,\n                },\n            });\n        }\n    });\n}, 200));\n\nfunction loadLink(hrefFull: string, _hrefPartial: string, _publicationJsonUrl: string) {\n    if (_webviews.length) {\n        _webviews[0].setAttribute(\"src\", hrefFull);\n        // _webviews[0].getWebContents().loadURL(tocLinkHref, { extraHeaders: \"pragma: no-cache\\n\" });\n        // _webviews[0].loadURL(tocLinkHref, { extraHeaders: \"pragma: no-cache\\n\" });\n    }\n}\n\nfunction startNavigatorExperiment() {\n\n    // document.body.style.backgroundColor = \"silver\";\n\n    // const h1 = document.querySelector(\"html > body > h1\");\n    // if (h1) {\n    //     (h1 as HTMLElement).style.color = \"green\";\n    // }\n\n    // const readerChrome = document.getElementById(\"reader_chrome\");\n    // const readerControls = document.getElementById(\"reader_controls\");\n\n    // const showControlsButton = document.getElementById(\"showControlsButton\");\n    // if (showControlsButton) {\n    //     showControlsButton.style.display = \"block\";\n    //     showControlsButton.addEventListener(\"click\", (_event) => {\n    //         if (readerControls) {\n    //             readerControls.style.display = \"block\";\n    //         }\n    //         const hideControlsButt = document.getElementById(\"hideControlsButton\");\n    //         if (hideControlsButt) {\n    //             hideControlsButt.style.display = \"block \";\n    //         }\n    //     });\n    // }\n    const webviewFull = createWebView();\n    _webviews.push(webviewFull);\n\n    const publicationViewport = document.getElementById(\"publication_viewport\");\n    if (publicationViewport) {\n        publicationViewport.appendChild(webviewFull);\n    }\n\n    // const hideControlsButton = document.getElementById(\"hideControlsButton\");\n    // if (hideControlsButton) {\n    //     hideControlsButton.addEventListener(\"click\", (_event) => {\n    //         if (readerControls) {\n    //             readerControls.style.display = \"none\";\n    //         }\n    //         hideControlsButton.style.display = \"none\";\n    //     });\n    // }\n\n    const cssButton1 = document.getElementById(\"cssButtonInject\");\n    if (cssButton1) {\n        cssButton1.addEventListener(\"click\", (_event) => {\n            const jsonMsg = { injectCSS: \"yes\", setCSS: \"ok\" };\n\n            _webviews.forEach((wv) => {\n                wv.send(R2_EVENT_READIUMCSS, JSON.stringify(jsonMsg)); // .getWebContents()\n            });\n        });\n    }\n\n    const cssButton2 = document.getElementById(\"cssButtonReset\");\n    if (cssButton2) {\n        cssButton2.addEventListener(\"click\", (_event) => {\n            const jsonMsg = { injectCSS: \"rollback\", setCSS: \"rollback\" };\n\n            _webviews.forEach((wv) => {\n                wv.send(R2_EVENT_READIUMCSS, JSON.stringify(jsonMsg)); // .getWebContents()\n            });\n        });\n    }\n\n    // tslint:disable-next-line:no-floating-promises\n    (async () => {\n\n        // try {\n        //     // hacky :) (just for testing);\n        //     // (initializes the LCP pass)\n        //     await fetch(publicationJsonUrl.replace(\"/pub/\",\n        //         \"/pub/*-\" +\n        //         \"ZWM0ZjJkYmIzYjE0MDA5NTU1MGM5YWZiYmI2OWI1ZDZmZDllODE0YjlkYTgyZmFkMGIzNGU5ZmNiZTU2ZjFjYg\" +\n        //         \"==-*\"));\n        // } catch (e) {\n        //     console.log(e);\n        // }\n\n        let response: Response | undefined;\n        try {\n            response = await fetch(publicationJsonUrl);\n        } catch (e) {\n            console.log(e);\n        }\n        if (!response) {\n            return;\n        }\n        if (!response.ok) {\n            console.log(\"BAD RESPONSE?!\");\n        }\n        response.headers.forEach((arg0: any, arg1: any) => {\n            console.log(arg0 + \" => \" + arg1);\n        });\n\n        let publicationJson: any | undefined;\n        try {\n            publicationJson = await response.json();\n        } catch (e) {\n            console.log(e);\n        }\n        if (!publicationJson) {\n            return;\n        }\n        console.log(publicationJson);\n\n        if (publicationJson.metadata && publicationJson.metadata.title) {\n            const h1 = document.getElementById(\"pubTitle\");\n            if (h1) {\n                (h1 as HTMLElement).textContent = publicationJson.metadata.title;\n            }\n        }\n\n        const buttonNavLeft = document.getElementById(\"buttonNavLeft\");\n        if (buttonNavLeft) {\n            buttonNavLeft.addEventListener(\"click\", (_event) => {\n                navLeftOrRight(false, publicationJsonUrl, publicationJson);\n            });\n        }\n\n        const buttonNavRight = document.getElementById(\"buttonNavRight\");\n        if (buttonNavRight) {\n            buttonNavRight.addEventListener(\"click\", (_event) => {\n                navLeftOrRight(true, publicationJsonUrl, publicationJson);\n            });\n        }\n\n        if (publicationJson.spine) {\n\n            riotMountSpineList(\"#reader_controls_SPINE\",\n                { spine: publicationJson.spine, url: publicationJsonUrl, basic: basicLinkTitles });\n\n            const firstLinear = publicationJson.spine.length ? publicationJson.spine[0] : undefined;\n            if (firstLinear) {\n                setTimeout(() => {\n                    const firstLinearLinkHref = publicationJsonUrl + \"/../\" + firstLinear.href;\n                    handleLink(firstLinearLinkHref);\n                }, 200);\n            }\n\n            // const readerControlsSpine = document.getElementById(\"reader_controls_SPINE\");\n            // let firstLinear: any | undefined;\n            // publicationJson.spine.forEach((spineItem: any) => {\n            //     // in Readium2, spine items are always linear (otherwise just \"resource\" collection)\n            //     if (!firstLinear) { // && (!spineItem.linear || spineItem.linear === \"yes\")) {\n            //         firstLinear = spineItem;\n            //     }\n            //     const spineItemLink = document.createElement(\"a\");\n            //     const spineItemLinkHref = publicationJsonUrl + \"/../\" + spineItem.href;\n            //     spineItemLink.setAttribute(\"href\", spineItemLinkHref);\n            //     spineItemLink.setAttribute(\"data-href\", spineItem.href);\n            //     spineItemLink.addEventListener(\"click\", (event) => {\n            //         event.preventDefault();\n            //         loadLink(spineItemLinkHref, spineItem.href, publicationJsonUrl);\n            //     });\n            //     spineItemLink.appendChild(document.createTextNode(spineItem.href));\n            //     if (readerControlsSpine) {\n            //         readerControlsSpine.appendChild(spineItemLink);\n            //         readerControlsSpine.appendChild(document.createElement(\"br\"));\n            //     }\n            // });\n            // if (firstLinear) {\n            //     setTimeout(() => {\n            //         const firstLinearLinkHref = publicationJsonUrl + \"/../\" + firstLinear.href;\n            //         loadLink(firstLinearLinkHref, firstLinear.href, publicationJsonUrl);\n            //     }, 200);\n            // }\n        }\n\n        if (publicationJson.toc && publicationJson.toc.length) {\n            const readerControlsToc = document.getElementById(\"reader_controls_TOC\");\n            if (readerControlsToc) {\n                appendToc(publicationJson.toc, readerControlsToc);\n            }\n        }\n        if (publicationJson[\"page-list\"] && publicationJson[\"page-list\"].length) {\n\n            riotMountSpineList(\"#reader_controls_PAGELIST\",\n                { spine: publicationJson[\"page-list\"], url: publicationJsonUrl, basic: basicLinkTitles });\n\n            // const readerControlsPageList = document.getElementById(\"reader_controls_PAGELIST\");\n            // if (readerControlsPageList) {\n            //     appendToc(publicationJson[\"page-list\"], readerControlsPageList, publicationJsonUrl);\n            // }\n        }\n\n        const landmarksData = [];\n        if (publicationJson.landmarks && publicationJson.landmarks.length) {\n            landmarksData.push({\n                label: \"Main\",\n                spine: publicationJson.landmarks,\n                url: publicationJsonUrl,\n            });\n        }\n        if (publicationJson.lot && publicationJson.lot.length) {\n            landmarksData.push({\n                label: \"Tables\",\n                spine: publicationJson.lot,\n                url: publicationJsonUrl,\n            });\n        }\n        if (publicationJson.loi && publicationJson.loi.length) {\n            landmarksData.push({\n                label: \"Illustrations\",\n                spine: publicationJson.loi,\n                url: publicationJsonUrl,\n            });\n        }\n        if (publicationJson.lov && publicationJson.lov.length) {\n            landmarksData.push({\n                label: \"Video\",\n                spine: publicationJson.lov,\n                url: publicationJsonUrl,\n            });\n        }\n        if (publicationJson.loa && publicationJson.loa.length) {\n            landmarksData.push({\n                label: \"Audio\",\n                spine: publicationJson.loa,\n                url: publicationJsonUrl,\n            });\n        }\n        if (landmarksData.length) {\n            // landmarksData.push({\n            //     label: \"Testing...\",\n            //     spine: publicationJson.landmarks,\n            //     url: publicationJsonUrl,\n            // });\n            riotMountSpineListGroup(\"#reader_controls_LANDMARKS\",\n                { spinegroup: landmarksData, url: publicationJsonUrl, basic: basicLinkTitles });\n        }\n\n        // const readerControlsLandmarks = document.getElementById(\"reader_controls_LANDMARKS\");\n        // if (readerControlsLandmarks) {\n        //     if (publicationJson.landmarks && publicationJson.landmarks.length) {\n        //         appendToc(publicationJson.landmarks, readerControlsLandmarks, publicationJsonUrl);\n        //     }\n        //     if (publicationJson.lot && publicationJson.lot.length) {\n        //         readerControlsLandmarks.appendChild(document.createElement(\"hr\"));\n        //         appendToc(publicationJson.lot, readerControlsLandmarks, publicationJsonUrl);\n        //     }\n        //     if (publicationJson.loa && publicationJson.loa.length) {\n        //         readerControlsLandmarks.appendChild(document.createElement(\"hr\"));\n        //         appendToc(publicationJson.loa, readerControlsLandmarks, publicationJsonUrl);\n        //     }\n        //     if (publicationJson.loi && publicationJson.loi.length) {\n        //         readerControlsLandmarks.appendChild(document.createElement(\"hr\"));\n        //         appendToc(publicationJson.loi, readerControlsLandmarks, publicationJsonUrl);\n        //     }\n        //     if (publicationJson.lov && publicationJson.lov.length) {\n        //         readerControlsLandmarks.appendChild(document.createElement(\"hr\"));\n        //         appendToc(publicationJson.lov, readerControlsLandmarks, publicationJsonUrl);\n        //     }\n        // }\n    })();\n    //     const spineItemUrl = publicationJsonUrl + \"/../\" + publicationJson.spine[0].href;\n    //     console.log(spineItemUrl);\n    //     webview1.setAttribute(\"src\", spineItemUrl);\n\n    // const a = document.querySelector(\"html > body > a\");\n    // a.click();\n}\n\nfunction appendToc(json: any, anchor: HTMLElement) {\n\n    const ul = document.createElement(\"ul\");\n    // ul.setAttribute(\"class\", \"mdc-list mdc-list--dense\");\n\n    json.forEach((tocLinkJson: any) => {\n        const li = document.createElement(\"li\");\n        // li.setAttribute(\"class\", \"mdc-list-item\");\n\n        if (!tocLinkJson.title) {\n            tocLinkJson.title = \"xxx\";\n        }\n\n        if (tocLinkJson.href) {\n            const tocLink = document.createElement(\"a\");\n            const tocLinkHref = publicationJsonUrl + \"/../\" + tocLinkJson.href;\n            tocLink.setAttribute(\"href\", tocLinkHref);\n            tocLink.setAttribute(\"data-href\", tocLinkJson.href);\n            tocLink.setAttribute(\"title\", tocLinkJson.href);\n            tocLink.addEventListener(\"click\", (event) => {\n                event.preventDefault();\n                handleLink(tocLinkHref);\n                // loadLink(tocLinkHref, tocLinkJson.href, publicationJsonUrl);\n            });\n            const linkSpan = document.createElement(\"span\");\n            linkSpan.setAttribute(\"class\", \"mdc-list-item__text\");\n            linkSpan.appendChild(document.createTextNode(tocLinkJson.title));\n\n            if (!basicLinkTitles) {\n                const tocHeading = document.createElement(\"span\");\n                tocHeading.setAttribute(\"class\", \"mdc-list-item__text__secondary\");\n                tocHeading.appendChild(document.createTextNode(tocLinkJson.href));\n                linkSpan.appendChild(tocHeading);\n            }\n\n            tocLink.appendChild(linkSpan);\n            li.appendChild(tocLink);\n\n            // const br = document.createElement(\"br\");\n            // li.appendChild(br);\n\n        } else {\n            const tocHeading = document.createElement(\"span\");\n            // tocHeading.setAttribute(\"style\", \"padding-bottom: 1em;\");\n            tocHeading.setAttribute(\"class\", \"mdc-list-item__text__secondary\");\n            tocHeading.appendChild(document.createTextNode(tocLinkJson.title));\n            li.appendChild(tocHeading);\n        }\n\n        ul.appendChild(li);\n\n        if (tocLinkJson.children && tocLinkJson.children.length) {\n            appendToc(tocLinkJson.children, li);\n        }\n    });\n\n    anchor.appendChild(ul);\n}\n\nfunction navLeftOrRight(_right: boolean, _publicationJsonUrl: string, _publicationJson: any) {\n    // TODO: publication spine + pagination state\n}\n"]}