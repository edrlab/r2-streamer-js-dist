!function e(t,n,o){function r(c,a){if(!n[c]){if(!t[c]){var l="function"==typeof require&&require;if(!a&&l)return l(c,!0);if(i)return i(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var s=n[c]={exports:{}};t[c][0].call(s.exports,function(e){var n=t[c][1][e];return r(n||e)},s,s.exports,e,t,n,o)}return n[c].exports}for(var i="function"==typeof require&&require,c=0;c<o.length;c++)r(o[c]);return r}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("electron"),r=e("./index_navigator"),i=e("./querystring");console.log("INDEX"),console.log(window.location),console.log(document.baseURI),console.log(document.URL);var c=i.getURLQueryParams(),a=c.pub;console.log(" (((( publicationJsonUrl )))) "+a);var l=c.lcpHint;window.onerror=function(e){console.log("Error",e)},o.ipcRenderer.on("tryLcpPass",function(e,t,n){console.log(t),console.log(n);var o=document.getElementById("lcpPassInput");o&&(o.value=n,t&&setTimeout(function(){var e=document.getElementById("lcpPassForm");e&&(e.style.display="none")},1e3))}),window.addEventListener("DOMContentLoaded",function(){var e=a.replace(/.*\/pub\/(.*)\/manifest.json/,"$1");console.log(e);var t=window.atob(e);console.log(t);var n=t.substr(t.lastIndexOf("/")+1,t.length-1),i=document.querySelector("html > body > h1 > span");i&&(i.textContent=n);var c=document.getElementById("lcpPassForm");if(c){var u=document.getElementById("lcpPassInput");if(u){l&&(u.value=l,c.style.display="inline-block",c.addEventListener("submit",function(e){e&&e.preventDefault();var n=u.value;return o.ipcRenderer.send("tryLcpPass",t,n),!1}));var s=document.getElementById("buttonStart");if(s){s.addEventListener("click",function(){s.setAttribute("disabled",""),s.style.display="none",r.startNavigatorExperiment(a)});var d=document.getElementById("buttonDebug");if(d){d.addEventListener("click",function(){document.documentElement.classList.contains("debug")?document.documentElement.classList.remove("debug"):document.documentElement.classList.add("debug")});var f=document.getElementById("buttonDevTools");f&&f.addEventListener("click",function(){o.ipcRenderer.send("devtools","test")})}}}}})},{"./index_navigator":2,"./querystring":3,electron:void 0}],2:[function(e,t,n){"use strict";function o(e,t,n,r){var i=document.createElement("ul");e.forEach(function(e){var t=document.createElement("li");if(e.title||(e.title="xxx"),e.href){var c=document.createElement("a"),a=n+"/../"+e.href;c.setAttribute("href",a),c.addEventListener("click",function(e){e.preventDefault(),r.setAttribute("src",a)}),c.appendChild(document.createTextNode(e.title)),t.appendChild(c);var l=document.createElement("br");t.appendChild(l),(u=document.createElement("span")).appendChild(document.createTextNode(e.href)),t.appendChild(u)}else{var u=document.createElement("span");u.appendChild(document.createTextNode(e.title)),t.appendChild(u)}i.appendChild(t),e.children&&e.children.length&&o(e.children,t,n,r)}),t.appendChild(i)}Object.defineProperty(n,"__esModule",{value:!0});var r=e("tslib"),i=e("debounce");n.startNavigatorExperiment=function(e){var t=this;document.body.style.backgroundColor="silver";var n=document.querySelector("html > body > h1");n&&(n.style.color="green");var c=document.getElementById("reader_controls"),a=document.getElementById("showControlsButton");a&&(a.style.display="block",a.addEventListener("click",function(e){c&&(c.style.display="block");var t=document.getElementById("hideControlsButton");t&&(t.style.display="block ")}));var l=document.createElement("webview");l.setAttribute("id","webview1"),l.setAttribute("webpreferences","nodeIntegration=0, nodeIntegrationInWorker=0, sandbox=0, javascript=1, contextIsolation=0, webSecurity=1, allowRunningInsecureContent=0"),l.setAttribute("partition","persist:publicationwebview"),l.setAttribute("httpreferrer",e),l.setAttribute("preload","./preload.js"),l.setAttribute("disableguestresize",""),window.addEventListener("resize",i(function(){var e=l.clientWidth,t=l.clientHeight,n=l.getWebContents();n&&e&&t&&n.setSize({normal:{height:t,width:e}})},200)),l.addEventListener("ipc-message",function(e){console.log("webview1 ipc-message"),console.log(e.channel),"readium"===e.channel&&console.log(e.args)}),l.addEventListener("dom-ready",function(){var e=document.getElementById("cssButtonInject");if(e){e.removeAttribute("disabled");var t=document.getElementById("cssButtonReset");t&&t.removeAttribute("disabled")}});var u=document.getElementById("publication_viewport");u&&u.appendChild(l);var s=document.getElementById("hideControlsButton");s&&s.addEventListener("click",function(e){c&&(c.style.display="none"),s.style.display="none"});var d=document.getElementById("cssButtonInject");d&&d.addEventListener("click",function(e){var t={injectCSS:"yes",setCSS:"ok"};l.send("readium",JSON.stringify(t))});var f=document.getElementById("cssButtonReset");f&&f.addEventListener("click",function(e){var t={injectCSS:"rollback",setCSS:"rollback"};l.send("readium",JSON.stringify(t))}),r.__awaiter(t,void 0,void 0,function(){var t,n,i,c,a,u,s,d;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,fetch(e)];case 1:return t=r.sent(),[3,3];case 2:return n=r.sent(),console.log(n),[3,3];case 3:if(!t)return[2];t.ok||console.log("BAD RESPONSE?!"),t.headers.forEach(function(e,t){console.log(e+" => "+t)}),r.label=4;case 4:return r.trys.push([4,6,,7]),[4,t.json()];case 5:return i=r.sent(),[3,7];case 6:return c=r.sent(),console.log(c),[3,7];case 7:return i?(console.log(i),i.spine&&(a=document.getElementById("reader_controls_SPINE"),i.spine.forEach(function(t){var n=document.createElement("a"),o=e+"/../"+t.href;n.setAttribute("href",o),n.addEventListener("click",function(e){e.preventDefault(),l.setAttribute("src",o)}),n.appendChild(document.createTextNode(t.href)),a&&(a.appendChild(n),a.appendChild(document.createElement("br")))})),i.toc&&i.toc.length&&(u=document.getElementById("reader_controls_TOC"))&&o(i.toc,u,e,l),i["page-list"]&&i["page-list"].length&&(s=document.getElementById("reader_controls_PAGELIST"))&&o(i["page-list"],s,e,l),(d=document.getElementById("reader_controls_LANDMARKS"))&&(i.landmarks&&i.landmarks.length&&o(i.landmarks,d,e,l),i.lot&&i.lot.length&&(d.appendChild(document.createElement("hr")),o(i.lot,d,e,l)),i.loa&&i.loa.length&&(d.appendChild(document.createElement("hr")),o(i.loa,d,e,l)),i.loi&&i.loi.length&&(d.appendChild(document.createElement("hr")),o(i.loi,d,e,l)),i.lov&&i.lov.length&&(d.appendChild(document.createElement("hr")),o(i.lov,d,e,l))),[2]):[2]}})})}},{debounce:4,tslib:5}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getURLQueryParams=function(){var e={},t=window.location.search;return t&&t.length&&(t=t.substring(1)).split("&").forEach(function(t){var n=t.split("=");n.length>1&&(e[n[0]]=decodeURIComponent(n[1]))}),e}},{}],4:[function(e,t,n){t.exports=function(e,t,n){function o(){var u=Date.now()-a;u<t&&u>=0?r=setTimeout(o,t-u):(r=null,n||(l=e.apply(c,i),c=i=null))}var r,i,c,a,l;null==t&&(t=100);var u=function(){c=this,i=arguments,a=Date.now();var u=n&&!r;return r||(r=setTimeout(o,t)),u&&(l=e.apply(c,i),c=i=null),l};return u.clear=function(){r&&(clearTimeout(r),r=null)},u}},{}],5:[function(e,t,n){(function(e){var n,o,r,i,c,a,l,u,s,d,f,p,y,m,v,h;!function(n){function o(e,t){return function(n,o){return e[n]=t?t(n,o):o}}var r="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:{};"function"==typeof define&&define.amd?define("tslib",["exports"],function(e){n(o(r,o(e)))}):n("object"==typeof t&&"object"==typeof t.exports?o(r,o(t.exports)):o(r))}(function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};n=function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)},o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},r=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&(n[o[r]]=e[o[r]]);return n},i=function(e,t,n,o){var r,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(c=(i<3?r(c):i>3?r(t,n,c):r(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c},c=function(e,t){return function(n,o){t(n,o,e)}},a=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{l(o.next(e))}catch(e){i(e)}}function a(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(c,a)}l((o=o.apply(e,t||[])).next())})},u=function(e,t){function n(e){return function(t){return o([e,t])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,i&&(c=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(c=c.call(i,n[1])).done)return c;switch(i=0,c&&(n=[0,c.value]),n[0]){case 0:case 1:c=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,i=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(c=l.trys,!(c=c.length>0&&c[c.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!c||n[1]>c[0]&&n[1]<c[3])){l.label=n[1];break}if(6===n[0]&&l.label<c[1]){l.label=c[1],c=n;break}if(c&&l.label<c[2]){l.label=c[2],l.ops.push(n);break}c[2]&&l.ops.pop(),l.trys.pop();continue}n=t.call(e,l)}catch(e){n=[6,e],i=0}finally{r=c=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,i,c,a,l={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},s=function(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])},d=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},f=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)c.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return c},p=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(f(arguments[t]));return e},y=function(e){return this instanceof y?(this.v=e,this):new y(e)},m=function(e,t,n){function o(e){s[e]&&(u[e]=function(t){return new Promise(function(n,o){d.push([e,t,n,o])>1||r(e,t)})})}function r(e,t){try{i(s[e](t))}catch(e){l(d[0][3],e)}}function i(e){e.value instanceof y?Promise.resolve(e.value.v).then(c,a):l(d[0][2],e)}function c(e){r("next",e)}function a(e){r("throw",e)}function l(e,t){e(t),d.shift(),d.length&&r(d[0][0],d[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var u,s=n.apply(e,t||[]),d=[];return u={},o("next"),o("throw"),o("return"),u[Symbol.asyncIterator]=function(){return this},u},v=function(e){function t(t,r){e[t]&&(n[t]=function(n){return(o=!o)?{value:y(e[t](n)),done:"return"===t}:r?r(n):n})}var n,o;return n={},t("next"),t("throw",function(e){throw e}),t("return"),n[Symbol.iterator]=function(){return this},n},h=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):"function"==typeof d?d(e):e[Symbol.iterator]()},e("__extends",n),e("__assign",o),e("__rest",r),e("__decorate",i),e("__param",c),e("__metadata",a),e("__awaiter",l),e("__generator",u),e("__exportStar",s),e("__values",d),e("__read",f),e("__spread",p),e("__await",y),e("__asyncGenerator",m),e("__asyncDelegator",v),e("__asyncValues",h)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]);
//# sourceMappingURL=browserify_bundle.min.js.map