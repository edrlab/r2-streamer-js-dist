{"version":3,"file":"opds2-publication.js","sourceRoot":"","sources":["../../../../../src/opds/opds2/opds2-publication.ts"],"names":[],"mappings":"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","sourcesContent":["// https://github.com/edcarroll/ta-json\r\nimport {\r\n    JsonElementType,\r\n    JsonObject,\r\n    JsonProperty,\r\n    OnDeserialized,\r\n} from \"ta-json\";\r\n\r\nimport { OPDSBelongsTo } from \"./opds2-belongsTo\";\r\nimport { OPDSCollection } from \"./opds2-collection\";\r\nimport { OPDSContributor } from \"./opds2-contributor\";\r\nimport { OPDSLink } from \"./opds2-link\";\r\nimport { OPDSPublicationMetadata } from \"./opds2-publicationMetadata\";\r\n\r\n@JsonObject()\r\nexport class OPDSPublication {\r\n\r\n    @JsonProperty(\"metadata\")\r\n    public Metadata: OPDSPublicationMetadata;\r\n\r\n    @JsonProperty(\"links\")\r\n    @JsonElementType(OPDSLink)\r\n    public Links: OPDSLink[];\r\n\r\n    @JsonProperty(\"images\")\r\n    @JsonElementType(OPDSLink)\r\n    public Images: OPDSLink[];\r\n\r\n    public findFirstLinkByRel(rel: string): OPDSLink | undefined {\r\n\r\n        return this.Links ? this.Links.find((l) => {\r\n            return l.HasRel(rel);\r\n        }) : undefined;\r\n    }\r\n\r\n    public AddImage(href: string, typeImage: string, height: number, width: number) {\r\n        const i = new OPDSLink();\r\n\r\n        i.Href = href;\r\n        i.TypeLink = typeImage;\r\n        if (height) {\r\n            i.Height = height;\r\n        }\r\n        if (width) {\r\n            i.Width = width;\r\n        }\r\n\r\n        if (!this.Images) {\r\n            this.Images = [];\r\n        }\r\n        this.Images.push(i);\r\n    }\r\n\r\n    public AddLink(href: string, typeLink: string, rel: string, title: string) {\r\n        const l = new OPDSLink();\r\n        l.Href = href;\r\n        l.TypeLink = typeLink;\r\n        if (rel) {\r\n            l.AddRel(rel);\r\n        }\r\n        if (title) {\r\n            l.Title = title;\r\n        }\r\n\r\n        if (!this.Links) {\r\n            this.Links = [];\r\n        }\r\n        this.Links.push(l);\r\n    }\r\n\r\n    public AddAuthor(name: string, identifier: string, sortAs: string, href: string, typeLink: string) {\r\n        const c = new OPDSContributor();\r\n        c.Name = name;\r\n        if (identifier) {\r\n            c.Identifier = identifier;\r\n        }\r\n        if (sortAs) {\r\n            c.SortAs = sortAs;\r\n        }\r\n\r\n        const l = new OPDSLink();\r\n        if (href) {\r\n            l.Href = href;\r\n        }\r\n        if (typeLink) {\r\n            l.TypeLink = typeLink;\r\n        }\r\n\r\n        if (href) {\r\n            c.Links = [];\r\n            c.Links.push(l);\r\n        }\r\n\r\n        if (!this.Metadata) {\r\n            this.Metadata = new OPDSPublicationMetadata();\r\n        }\r\n        if (!this.Metadata.Author) {\r\n            this.Metadata.Author = [];\r\n        }\r\n        this.Metadata.Author.push(c);\r\n    }\r\n\r\n    public AddSerie(name: string, position: number, href: string, typeLink: string) {\r\n\r\n        const c = new OPDSCollection();\r\n        c.Name = name;\r\n        c.Position = position;\r\n\r\n        const l = new OPDSLink();\r\n        if (href) {\r\n            l.Href = href;\r\n        }\r\n        if (typeLink) {\r\n            l.TypeLink = typeLink;\r\n        }\r\n\r\n        if (href) {\r\n            c.Links = [];\r\n            c.Links.push(l);\r\n        }\r\n\r\n        if (!this.Metadata) {\r\n            this.Metadata = new OPDSPublicationMetadata();\r\n        }\r\n        if (!this.Metadata.BelongsTo) {\r\n            this.Metadata.BelongsTo = new OPDSBelongsTo();\r\n        }\r\n        if (!this.Metadata.BelongsTo.Series) {\r\n            this.Metadata.BelongsTo.Series = [];\r\n        }\r\n\r\n        this.Metadata.BelongsTo.Series.push(c);\r\n    }\r\n\r\n    public AddPublisher(name: string, href: string, typeLink: string) {\r\n        const c = new OPDSContributor();\r\n        c.Name = name;\r\n\r\n        const l = new OPDSLink();\r\n        if (href) {\r\n            l.Href = href;\r\n        }\r\n        if (typeLink) {\r\n            l.TypeLink = typeLink;\r\n        }\r\n\r\n        if (href) {\r\n            c.Links = [];\r\n            c.Links.push(l);\r\n        }\r\n\r\n        if (!this.Metadata) {\r\n            this.Metadata = new OPDSPublicationMetadata();\r\n        }\r\n        if (!this.Metadata.Publisher) {\r\n            this.Metadata.Publisher = [];\r\n        }\r\n        this.Metadata.Publisher.push(c);\r\n    }\r\n\r\n    @OnDeserialized()\r\n    // tslint:disable-next-line:no-unused-variable\r\n    // @ts-ignore: TS6133 (is declared but its value is never read.)\r\n    private _OnDeserialized() {\r\n        if (!this.Metadata) {\r\n            console.log(\"OPDSPublication.Metadata is not set!\");\r\n        }\r\n        if (!this.Links) {\r\n            console.log(\"OPDSPublication.Links is not set!\");\r\n        }\r\n        if (!this.Images) {\r\n            console.log(\"OPDSPublication.Images is not set!\");\r\n        }\r\n    }\r\n}\r\n"]}